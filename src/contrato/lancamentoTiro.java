/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package contrato;

import DAO.ContasReceberDAO;
import DAO.lancamentoTiroDAO;
import DAO.lancDocumentDAO;
import DAO.listaplanosDAO;
import Impressoes.ProdutoImpresso;
import Impressoes.RelacaoDeProdutos;
import Logs.gravarLog;
import model.CadContasRecPagar;
import classes.ClsAutoComplete;
import model.clsConfig;
import model.clsLancamentoTiro;
import classes.clsaux;
import com.sun.glass.events.KeyEvent;
import conexoes.conexao;
import grafic.interfac.Cadclientes;
import grafic.interfac.pesquisa.formProcuraCliente;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.lang.reflect.Array;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.AbstractAction;
import javax.swing.DefaultComboBoxModel;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.InputMap;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Rodrigo
 */
public class lancamentoTiro extends javax.swing.JDialog {

   

    
    public lancamentoTiro(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        this.carregaComponentes();
        this.inicializa();
        this.mapaTeclas();
    }
    public static String idcliente,idmvpre,idmovto=null,idcategoria="0",valorvenda="0,00";
    public static int idarma=0,idprod=0,ultimoitem=0,ultimoarma=0;
    public static Double totalreserva=0.00, desco=0.00;
    public static ArrayList dadosfinalizadora=null;
    public static String validafinvenda="N";
    
   

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txtAtirador = new javax.swing.JTextField();
        btnProcuraAtirador = new javax.swing.JButton();
        jSeparator1 = new javax.swing.JSeparator();
        lbCadastroAtirador = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        lbPlano = new javax.swing.JLabel();
        jSeparator2 = new javax.swing.JSeparator();
        jLabel13 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        lbTotal = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        lbTotalmun = new javax.swing.JLabel();
        lbTotalitem = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        lbPreVenda = new javax.swing.JLabel();
        txtIdpvenda = new javax.swing.JLabel();
        jSeparator3 = new javax.swing.JSeparator();
        lbLogo = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        ftData = new javax.swing.JFormattedTextField();
        txtSocio = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel4 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        cbArmasRegistradas = new javax.swing.JComboBox<>();
        jLabel4 = new javax.swing.JLabel();
        btnRegistrarTiro = new javax.swing.JButton();
        jSeparator4 = new javax.swing.JSeparator();
        lbExcluieq = new javax.swing.JLabel();
        cbQtdemunicao = new javax.swing.JTextField();
        txtCodBarras = new javax.swing.JTextField();
        jScrollPane6 = new javax.swing.JScrollPane();
        tblArmas = new javax.swing.JTable();
        jPanel5 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        cbProdutos = new javax.swing.JComboBox<>();
        jLabel17 = new javax.swing.JLabel();
        btnConfirma = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        tblProdutos = new javax.swing.JTable();
        jSeparator5 = new javax.swing.JSeparator();
        lbExcluirpr = new javax.swing.JLabel();
        cbQuantidadeproduto = new javax.swing.JTextField();
        txtCodBarrasProd = new javax.swing.JTextField();
        btnRegistrarTiro1 = new javax.swing.JButton();
        btnRegistrarTiro2 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel1.setBackground(new java.awt.Color(219, 227, 227));

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setToolTipText("");
        jPanel2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jPanel2FocusGained(evt);
            }
        });

        jLabel2.setFont(new java.awt.Font("Arial", 1, 16)); // NOI18N
        jLabel2.setText("Sócio");

        txtAtirador.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtAtirador.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtAtiradorFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtAtiradorFocusLost(evt);
            }
        });
        txtAtirador.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAtiradorActionPerformed(evt);
            }
        });

        btnProcuraAtirador.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Procura_2.png"))); // NOI18N
        btnProcuraAtirador.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnProcuraAtiradorActionPerformed(evt);
            }
        });

        lbCadastroAtirador.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/atirad2.png"))); // NOI18N
        lbCadastroAtirador.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
            public void mouseMoved(java.awt.event.MouseEvent evt) {
                lbCadastroAtiradorMouseMoved(evt);
            }
        });
        lbCadastroAtirador.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbCadastroAtiradorMouseClicked(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Segoe UI Semilight", 0, 12)); // NOI18N
        jLabel1.setText("Plano :");

        lbPlano.setFont(new java.awt.Font("Arial Black", 0, 24)); // NOI18N
        lbPlano.setForeground(new java.awt.Color(153, 0, 51));
        lbPlano.setPreferredSize(new java.awt.Dimension(148, 35));

        jLabel13.setFont(new java.awt.Font("Segoe UI Semilight", 1, 18)); // NOI18N
        jLabel13.setText("Totais Munição :");

        jLabel15.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        jLabel15.setText("R$");

        jPanel6.setBackground(new java.awt.Color(255, 255, 255));
        jPanel6.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 0, 0), 2));

        lbTotal.setFont(new java.awt.Font("Arial Black", 0, 62)); // NOI18N
        lbTotal.setForeground(new java.awt.Color(153, 0, 0));
        lbTotal.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lbTotal.setText("0,00");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lbTotal, javax.swing.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lbTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 89, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel18.setFont(new java.awt.Font("Segoe UI Semilight", 1, 18)); // NOI18N
        jLabel18.setText("Totais Produtos :");

        lbTotalmun.setFont(new java.awt.Font("Arial Black", 0, 16)); // NOI18N
        lbTotalmun.setForeground(new java.awt.Color(153, 0, 0));
        lbTotalmun.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lbTotalmun.setText("0,00");
        lbTotalmun.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        lbTotalmun.setPreferredSize(new java.awt.Dimension(60, 23));

        lbTotalitem.setFont(new java.awt.Font("Arial Black", 0, 16)); // NOI18N
        lbTotalitem.setForeground(new java.awt.Color(153, 0, 0));
        lbTotalitem.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lbTotalitem.setText("0,00");
        lbTotalitem.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        lbTotalitem.setPreferredSize(new java.awt.Dimension(60, 23));

        jLabel21.setText(".......................................................");
        jLabel21.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jLabel21FocusGained(evt);
            }
        });

        jLabel22.setText("......................................................");

        lbPreVenda.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/DocumentoMenu.png"))); // NOI18N
        lbPreVenda.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
            public void mouseMoved(java.awt.event.MouseEvent evt) {
                lbPreVendaMouseMoved(evt);
            }
        });
        lbPreVenda.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbPreVendaMouseClicked(evt);
            }
        });

        txtIdpvenda.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        txtIdpvenda.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        txtIdpvenda.setText("0");
        txtIdpvenda.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        txtIdpvenda.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtIdpvendaFocusGained(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Arial", 0, 16)); // NOI18N
        jLabel6.setText("Data:");

        try {
            ftData.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftData.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N

        txtSocio.addContainerListener(new java.awt.event.ContainerAdapter() {
            public void componentRemoved(java.awt.event.ContainerEvent evt) {
                txtSocioComponentRemoved(evt);
            }
        });
        txtSocio.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtSocioFocusLost(evt);
            }
        });
        txtSocio.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtSocioKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(40, 40, 40)
                        .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 452, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lbPlano, javax.swing.GroupLayout.PREFERRED_SIZE, 410, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, 452, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(lbCadastroAtirador)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(lbPreVenda)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(txtIdpvenda, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(21, 21, 21)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(39, 39, 39)
                                .addComponent(jLabel15)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 452, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createSequentialGroup()
                                    .addComponent(jLabel13)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jLabel21)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(lbTotalmun, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createSequentialGroup()
                                    .addComponent(jLabel18)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(jLabel22)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(lbTotalitem, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(txtAtirador, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnProcuraAtirador)
                                .addGap(130, 130, 130)
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(ftData, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel2)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtSocio, javax.swing.GroupLayout.PREFERRED_SIZE, 398, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(lbLogo, javax.swing.GroupLayout.PREFERRED_SIZE, 164, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(188, 188, 188))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(lbCadastroAtirador, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbPreVenda, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(txtIdpvenda, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(25, 25, 25)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txtSocio, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtAtirador, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnProcuraAtirador, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel6)
                        .addComponent(ftData, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(28, 28, 28)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1)
                    .addComponent(lbPlano, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(lbTotalmun, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel21))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel18)
                    .addComponent(lbTotalitem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel22))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbLogo, javax.swing.GroupLayout.PREFERRED_SIZE, 174, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(57, 57, 57)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(164, 164, 164))
        );

        jPanel3.setBackground(new java.awt.Color(255, 255, 255));
        jPanel3.setForeground(new java.awt.Color(240, 240, 240));

        jPanel4.setBackground(new java.awt.Color(255, 255, 255));
        jPanel4.setForeground(new java.awt.Color(51, 255, 0));

        jLabel5.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        jLabel5.setText("Equipamentos");

        cbArmasRegistradas.setFont(new java.awt.Font("Segoe UI Semilight", 0, 18)); // NOI18N
        cbArmasRegistradas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbArmasRegistradasActionPerformed(evt);
            }
        });

        jLabel4.setFont(new java.awt.Font("Arial", 1, 16)); // NOI18N
        jLabel4.setText("Quantidade");

        btnRegistrarTiro.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        btnRegistrarTiro.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Confirma.png"))); // NOI18N
        btnRegistrarTiro.setText("Confirma");
        btnRegistrarTiro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegistrarTiroActionPerformed(evt);
            }
        });

        lbExcluieq.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/DelFinan.png"))); // NOI18N
        lbExcluieq.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbExcluieqMouseClicked(evt);
            }
        });

        cbQtdemunicao.setFont(new java.awt.Font("Arial", 1, 36)); // NOI18N
        cbQtdemunicao.setText("1");

        txtCodBarras.setFont(new java.awt.Font("Arial", 1, 24)); // NOI18N
        txtCodBarras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCodBarrasActionPerformed(evt);
            }
        });

        tblArmas.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Codigo", "Nome", "Qnt", "Vl Unit", "Total", "Id"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblArmas.getTableHeader().setReorderingAllowed(false);
        jScrollPane6.setViewportView(tblArmas);
        if (tblArmas.getColumnModel().getColumnCount() > 0) {
            tblArmas.getColumnModel().getColumn(0).setResizable(false);
            tblArmas.getColumnModel().getColumn(1).setResizable(false);
            tblArmas.getColumnModel().getColumn(1).setPreferredWidth(80);
            tblArmas.getColumnModel().getColumn(2).setResizable(false);
            tblArmas.getColumnModel().getColumn(3).setResizable(false);
            tblArmas.getColumnModel().getColumn(4).setResizable(false);
            tblArmas.getColumnModel().getColumn(5).setResizable(false);
            tblArmas.getColumnModel().getColumn(5).setPreferredWidth(15);
        }

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(txtCodBarras, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(cbArmasRegistradas, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(jSeparator4)
                    .addComponent(lbExcluieq, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 405, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(64, 64, 64))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(cbQtdemunicao)
                            .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(194, 194, 194)
                        .addComponent(btnRegistrarTiro, javax.swing.GroupLayout.PREFERRED_SIZE, 187, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 469, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(22, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addComponent(jLabel5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cbArmasRegistradas, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtCodBarras, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 19, Short.MAX_VALUE)
                .addComponent(jLabel4)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnRegistrarTiro, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbQtdemunicao))
                .addGap(18, 18, 18)
                .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(11, 11, 11)
                .addComponent(lbExcluieq)
                .addGap(37, 37, 37))
        );

        jTabbedPane1.addTab("Munição", jPanel4);

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));

        jLabel16.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        jLabel16.setText("Produtos");

        cbProdutos.setFont(new java.awt.Font("Segoe UI Semilight", 0, 18)); // NOI18N

        jLabel17.setFont(new java.awt.Font("Arial", 1, 16)); // NOI18N
        jLabel17.setText("Quantidade");

        btnConfirma.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        btnConfirma.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Confirma.png"))); // NOI18N
        btnConfirma.setText("Confirma");
        btnConfirma.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnConfirmaActionPerformed(evt);
            }
        });

        tblProdutos.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        tblProdutos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Codigo", "Nome", "Qnt", "Vl Unit", "Total", "Id"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblProdutos.getTableHeader().setReorderingAllowed(false);
        jScrollPane4.setViewportView(tblProdutos);
        if (tblProdutos.getColumnModel().getColumnCount() > 0) {
            tblProdutos.getColumnModel().getColumn(0).setResizable(false);
            tblProdutos.getColumnModel().getColumn(1).setResizable(false);
            tblProdutos.getColumnModel().getColumn(1).setPreferredWidth(80);
            tblProdutos.getColumnModel().getColumn(2).setResizable(false);
            tblProdutos.getColumnModel().getColumn(3).setResizable(false);
            tblProdutos.getColumnModel().getColumn(4).setResizable(false);
            tblProdutos.getColumnModel().getColumn(5).setResizable(false);
            tblProdutos.getColumnModel().getColumn(5).setPreferredWidth(15);
        }

        lbExcluirpr.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/DelFinan.png"))); // NOI18N
        lbExcluirpr.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbExcluirprMouseClicked(evt);
            }
        });

        cbQuantidadeproduto.setFont(new java.awt.Font("Arial", 1, 36)); // NOI18N
        cbQuantidadeproduto.setText("1");
        cbQuantidadeproduto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbQuantidadeprodutoActionPerformed(evt);
            }
        });

        txtCodBarrasProd.setFont(new java.awt.Font("Arial", 1, 24)); // NOI18N
        txtCodBarrasProd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCodBarrasProdActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lbExcluirpr)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(jLabel16, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 394, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel17, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 469, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel5Layout.createSequentialGroup()
                                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(cbQuantidadeproduto)
                                    .addComponent(txtCodBarrasProd))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(btnConfirma, javax.swing.GroupLayout.PREFERRED_SIZE, 187, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(cbProdutos, javax.swing.GroupLayout.PREFERRED_SIZE, 371, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addComponent(jSeparator5, javax.swing.GroupLayout.PREFERRED_SIZE, 469, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(22, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(jLabel16)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cbProdutos, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtCodBarrasProd, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(jLabel17)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cbQuantidadeproduto, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(2, 2, 2)
                        .addComponent(btnConfirma, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addComponent(jSeparator5, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(11, 11, 11)
                .addComponent(lbExcluirpr)
                .addContainerGap(37, Short.MAX_VALUE))
        );

        jPanel5Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {cbProdutos, txtCodBarrasProd});

        jTabbedPane1.addTab("Produtos", jPanel5);

        btnRegistrarTiro1.setBackground(new java.awt.Color(255, 255, 255));
        btnRegistrarTiro1.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        btnRegistrarTiro1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Confirma.png"))); // NOI18N
        btnRegistrarTiro1.setText("Pagamento");
        btnRegistrarTiro1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegistrarTiro1ActionPerformed(evt);
            }
        });

        btnRegistrarTiro2.setBackground(new java.awt.Color(255, 255, 255));
        btnRegistrarTiro2.setFont(new java.awt.Font("Arial", 1, 18)); // NOI18N
        btnRegistrarTiro2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Documento.png"))); // NOI18N
        btnRegistrarTiro2.setText("Pre - Venda");
        btnRegistrarTiro2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegistrarTiro2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addGap(40, 40, 40)
                .addComponent(btnRegistrarTiro2, javax.swing.GroupLayout.PREFERRED_SIZE, 187, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(73, 73, 73)
                .addComponent(btnRegistrarTiro1, javax.swing.GroupLayout.PREFERRED_SIZE, 184, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 506, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 12, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 475, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnRegistrarTiro1, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnRegistrarTiro2, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, 636, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 11, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void lbCadastroAtiradorMouseMoved(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbCadastroAtiradorMouseMoved
        lbCadastroAtirador.setToolTipText("Cadastrar Atirador");
    }//GEN-LAST:event_lbCadastroAtiradorMouseMoved

    private void lbCadastroAtiradorMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbCadastroAtiradorMouseClicked
        Cadclientes dialog = new Cadclientes(new javax.swing.JFrame(), true);
        dialog.setVisible(true);
       //cadVisitante dialog = new cadVisitante(new javax.swing.JFrame(), true);
       // dialog.setVisible(true);
    }//GEN-LAST:event_lbCadastroAtiradorMouseClicked

    private void lbPreVendaMouseMoved(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbPreVendaMouseMoved
        lbPreVenda.setToolTipText("Importa Pre - Venda");
    }//GEN-LAST:event_lbPreVendaMouseMoved

    private void cbArmasRegistradasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbArmasRegistradasActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbArmasRegistradasActionPerformed

    private void btnConfirmaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnConfirmaActionPerformed
       this.acaoBotaogravarproduto(cbProdutos.getSelectedItem().toString(),"","D");
    }//GEN-LAST:event_btnConfirmaActionPerformed

    private void btnRegistrarTiroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegistrarTiroActionPerformed
        this.acaoBotaogravararma(cbArmasRegistradas.getSelectedItem().toString(),"","D");
    }//GEN-LAST:event_btnRegistrarTiroActionPerformed

    private void txtAtiradorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAtiradorActionPerformed
       this.pegarAtirador(txtAtirador.getText());
    }//GEN-LAST:event_txtAtiradorActionPerformed

    private void btnRegistrarTiro2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegistrarTiro2ActionPerformed
        String id= txtIdpvenda.getText();
        if (lbTotal.getText().equals("0,00")){
            JOptionPane.showMessageDialog(null, "Pre-Venda com valor 0");
        }else if (idcliente==null){
           JOptionPane.showMessageDialog(null, "Falta inserir o parceiro"); 
        } else{

            if (ftData.getText().equals("  /  /    ")){
                JOptionPane.showMessageDialog(null, "Campo Data está incorreto");
            } else {
             if(id=="0"){
                    this.gravarPrevenda();
                }else {
                    this.alteraPrevenda();
                }
            }  
        } 
    }//GEN-LAST:event_btnRegistrarTiro2ActionPerformed

    private void lbPreVendaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbPreVendaMouseClicked
        frmPesquisaPreVenda dialog = new frmPesquisaPreVenda(new javax.swing.JFrame(), true);
        dialog.setVisible(true);
    }//GEN-LAST:event_lbPreVendaMouseClicked

    private void txtAtiradorFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtAtiradorFocusGained
      
    }//GEN-LAST:event_txtAtiradorFocusGained

    private void jPanel2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jPanel2FocusGained
      
    }//GEN-LAST:event_jPanel2FocusGained

    private void txtIdpvendaFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtIdpvendaFocusGained
        this.carregarAberturaPreVenda(txtIdpvenda.getText());
        txtCodBarras.requestFocus();
    }//GEN-LAST:event_txtIdpvendaFocusGained

    private void btnRegistrarTiro1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegistrarTiro1ActionPerformed
        if (idcliente==null){
           JOptionPane.showMessageDialog(null, "Falta inserir o parceiro"); 
        }else{     
            totalreserva=Double.parseDouble(lbTotal.getText().replaceAll(",", "."));
             pagamentoTiro dialog = new pagamentoTiro(new javax.swing.JFrame(), true);
             dialog.setVisible(true);
        }
           
    }//GEN-LAST:event_btnRegistrarTiro1ActionPerformed

    private void jLabel21FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jLabel21FocusGained
        System.out.println("recebeu o foco");
        if (validafinvenda=="S"){
                this.finalizaVenda();
        }
        
    }//GEN-LAST:event_jLabel21FocusGained

    private void btnProcuraAtiradorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnProcuraAtiradorActionPerformed
        formProcuraCliente dialog = new formProcuraCliente(new javax.swing.JFrame(), true);
        formProcuraCliente.idform="1";
        dialog.setVisible(true);
    }//GEN-LAST:event_btnProcuraAtiradorActionPerformed

    private void lbExcluieqMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbExcluieqMouseClicked
        String idc=tblArmas.getValueAt(tblArmas.getSelectedRow(), 5).toString();
        ((DefaultTableModel) tblArmas.getModel()).removeRow(tblArmas.getSelectedRow());
        if(txtIdpvenda.getText()=="0"){
        
        }else{
            this.cancelaItem(idc,"A");
        }
        this.calculaValorarma();
        this.calculaTotal();
    }//GEN-LAST:event_lbExcluieqMouseClicked

    private void lbExcluirprMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbExcluirprMouseClicked
        String id=tblProdutos.getValueAt(tblProdutos.getSelectedRow(), 5).toString();
        ((DefaultTableModel)tblProdutos.getModel()).removeRow(tblProdutos.getSelectedRow());
        if(txtIdpvenda.getText()=="0"){
        
        }else{
            this.cancelaItem(id,"P");
        }
        this.calculaValorproduto();
        this.calculaTotal();
    }//GEN-LAST:event_lbExcluirprMouseClicked

    private void cbQuantidadeprodutoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbQuantidadeprodutoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbQuantidadeprodutoActionPerformed

    private void txtCodBarrasProdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCodBarrasProdActionPerformed
       String valor=txtCodBarrasProd.getText();
       this.acaoBotaogravarproduto("", valor, "C");
       txtCodBarrasProd.setText("");
    }//GEN-LAST:event_txtCodBarrasProdActionPerformed

    private void txtCodBarrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCodBarrasActionPerformed
        String valortext=txtCodBarras.getText();
        this.acaoBotaogravararma("", valortext, "C");
        txtCodBarras.setText("");
    }//GEN-LAST:event_txtCodBarrasActionPerformed

    private void txtAtiradorFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtAtiradorFocusLost
        this.buscaDadosAtirador();
        //txtCodBarras.requestFocus();
    }//GEN-LAST:event_txtAtiradorFocusLost

    private void txtSocioKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSocioKeyPressed
       if (evt.getKeyCode()==KeyEvent.VK_ENTER){
          
       }
    }//GEN-LAST:event_txtSocioKeyPressed

    private void txtSocioComponentRemoved(java.awt.event.ContainerEvent evt) {//GEN-FIRST:event_txtSocioComponentRemoved
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSocioComponentRemoved

    private void txtSocioFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtSocioFocusLost
        if(txtSocio.getText().equals("")||txtSocio.getText().isEmpty()){
        
        } else{
            txtAtirador.setText(clsaux.retornaAposId(txtSocio.getText()));
            this.buscaDadosAtirador();
        }
            
    }//GEN-LAST:event_txtSocioFocusLost
    public void mapaTeclas(){
        txtAtirador.setFocusTraversalKeysEnabled(false);
        txtSocio.setFocusTraversalKeysEnabled(false);
         txtSocio.addKeyListener(new java.awt.event.KeyAdapter(){
            public void keyPressed(java.awt.event.KeyEvent evt){
                if (evt.getKeyCode()==KeyEvent.VK_TAB){
                    txtAtirador.requestFocus();
                }
            }
            });
         txtAtirador.addKeyListener(new java.awt.event.KeyAdapter(){
            public void keyPressed(java.awt.event.KeyEvent evt){
                if (evt.getKeyCode()==KeyEvent.VK_TAB||evt.getKeyCode()==KeyEvent.VK_ENTER){
                    txtCodBarras.requestFocus();
                }
            }
            });
    
    
    }
   
    public void carregaComponentes(){
        DefaultComboBoxModel cbm = new DefaultComboBoxModel(lancamentoTiroDAO.listaPro().toArray());
        cbProdutos.setModel(cbm);
        DefaultComboBoxModel cba= new DefaultComboBoxModel(lancamentoTiroDAO.listaarma().toArray());
        cbArmasRegistradas.setModel(cba);
        ftData.setText(clsaux.preencheData());
    }
    public void inicializa(){
        ArrayList<String> socio= new ArrayList();
        socio=listaplanosDAO.listaAtiradores("0");
        ClsAutoComplete.setupAutoComplete(txtSocio, socio);
        DefaultComboBoxModel cb= new DefaultComboBoxModel(listaplanosDAO.listaAtiradores("0").toArray());
        //cbSocios.setModel(cb);
        InputMap imp= this.getRootPane().getInputMap(JPanel.WHEN_IN_FOCUSED_WINDOW);
        imp.put(KeyStroke.getKeyStroke(KeyEvent.VK_F10,0),"busca");
        this.getRootPane().setInputMap(JPanel.WHEN_IN_FOCUSED_WINDOW, imp);
        this.getRootPane().getActionMap().put("busca", new AbstractAction(){
            public void actionPerformed(ActionEvent ev){
                formProcuraCliente dialo = new formProcuraCliente(new javax.swing.JFrame(), true);
                formProcuraCliente.idform="1";
                dialo.setVisible(true);
            }
        });
        //ImageIcon icone=new ImageIcon(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/imagens/Logotiro.png")));
        //lbLogo.setIcon(icone);
       // cbSocios.requestFocus();
    }
    public void buscaDadosAtirador(){
        String ret= txtAtirador.getText();
        
            if(ret.equals("")|| ret.isEmpty()){
                ret="0";
            }
            List atiradores= new ArrayList();
            atiradores=listaplanosDAO.listaAtiradores(ret);
            String retornoatirador=atiradores.get(0).toString();
            txtSocio.setText(retornoatirador);
            this.pegarAtirador(ret);
    }
    public void acaoBotaogravarproduto(String nomeitem, String cod, String parametro){
        String sqlpegainfitem="";
        if (clsConfig.precCatLanTiro.equals("S")){
            if (idcategoria.equals("4")){
                if(parametro.equals("C")){
                    System.out.println("1");
                sqlpegainfitem="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                "join tprecos tc on tp.id=tc.id\n" +
                                "join tbarras tb on tp.id=tb.id_produto\n" +
                                "left join tcat_precos tr on tp.id=tr.idprod\n"+
                                "where tb.codigo_barras='"+cod+"' AND tr.id_categoria="+idcategoria+";";
            }else{        
                    System.out.println("2");
                 sqlpegainfitem="select tp.id, tr.prec_venda, tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                    "join tprecos tc on tp.id=tc.id\n" +
                         "join tbarras tb on tp.id=tb.id_produto\n" +
                                    "left join tcat_precos tr on tp.id=tr.idprod\n" +
                                    "where tp.nomelongo='"+nomeitem+"'  AND tr.id_categoria="+idcategoria+";";
             }
            }
        else{
            if (parametro.equals("C")){
                System.out.println("3");
                sqlpegainfitem="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                "join tprecos tc on tp.id=tc.id\n" +
                                "join tbarras tb on tp.id=tb.id_produto\n" +
                                "where tb.codigo_barras='"+cod+"'";
            }else {
                System.out.println("4");
                sqlpegainfitem="select tp.id, tc.preco_venda,tp.nomelongo, tb.codigo_barras from tprodutos tp\n" +
                                    "join tprecos tc on tp.id=tc.id\n" +
                        "join tbarras tb on tp.id=tb.id_produto\n" +
                                    "where tp.nomelongo='"+nomeitem+"'";
            }
           }
        }else {
            if (parametro.equals("C")){
                System.out.println("5");
                sqlpegainfitem="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                "join tprecos tc on tp.id=tc.id\n" +
                                "join tbarras tb on tp.id=tb.id_produto\n" +
                                "where tb.codigo_barras='"+cod+"'";
            }else {
                System.out.println("6");
                sqlpegainfitem="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                    "join tprecos tc on tp.id=tc.id\n" +
                        "join tbarras tb on tp.id=tb.id_produto\n" +
                                    "where tp.nomelongo='"+nomeitem+"'";
            }
        }   
        try {
            PreparedStatement psinf= conexao.getPreparedStatementResult(sqlpegainfitem);
            ResultSet rsinf= psinf.executeQuery();
            rsinf.first();
            String id,total,descricao=null;
            Double preco,qnt=0.00;
            id=rsinf.getString(4);
            preco=rsinf.getDouble(2);
            descricao=rsinf.getString(3);
            qnt=Double.parseDouble(cbQuantidadeproduto.getText().replaceAll(",", "."));
            total= clsaux.formato(qnt*preco);
            DefaultTableModel tbpro= (DefaultTableModel) tblProdutos.getModel();
            idprod=idprod+1;
            tbpro.addRow(new Object[]{
                id,descricao,qnt,preco,total,idprod
            });
            rsinf.close();
            psinf.close();
            cbQuantidadeproduto.setText("1");
            cbQuantidadeproduto.requestFocus();
           
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
            gravarLog.main(ex.getMessage().toString());
            JOptionPane.showMessageDialog(null, "Erro ao buscar dados do produto\n Verifique o preço de venda da categoria...\n"+ex.getMessage());
        }
        this.calculaValorproduto();
    }
    public void calculaValorproduto(){
        int vlitem=0;
        vlitem=tblProdutos.getRowCount();
        Double total=0.00;
        for (int i=0; i<vlitem; i++){
            total=total+Double.parseDouble(tblProdutos.getValueAt(i, 4).toString().replaceAll(",", "."));
        }
        lbTotalitem.setText(clsaux.formato(total));
        this.calculaTotal();
        txtCodBarrasProd.requestFocus();
    }
    public void acaoBotaogravararma(String nomearma,String cod,String parame){
        String sqlpegainfarma="";
        if(clsConfig.precCatLanTiro.equals("S")){
        if(parame.equals("C")){
            sqlpegainfarma="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                            "join tprecos tc on tp.id=tc.id\n" +
                            "join tbarras tb on tp.id=tb.id_produto\n" +
                            "left join tcat_precos tr on tp.id=tr.idprod\n"+
                            "where tb.codigo_barras='"+cod+"' AND tr.id_categoria="+idcategoria+";";
            if (idcategoria.equals("0")){
                sqlpegainfarma="select tp.id, tc.preco_venda,tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                            "join tprecos tc on tp.id=tc.id\n" +
                            "join tbarras tb on tp.id=tb.id_produto\n" +
                            "where tb.codigo_barras='"+cod+"'"; 
                
                 }
        }else{        
             sqlpegainfarma="select tp.id, tr.prec_venda, tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                "join tprecos tc on tp.id=tc.id\n" +
                     "join tbarras tb on tp.id=tb.id_produto\n" +
                                "left join tcat_precos tr on tp.id=tr.idprod\n" +
                                "where tp.nomelongo='"+nomearma+"'  AND tr.id_categoria="+idcategoria+";";
            if (idcategoria.equals("0")){
                sqlpegainfarma="select tp.id, tc.preco_venda, tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                    "join tprecos tc on tp.id=tc.id\n" +
                        "join tbarras tb on tp.id=tb.id_produto\n" +
                                    "where tp.nomelongo='"+nomearma+"'";
            }
        }
        }else {
            if (parame.equals("C")){
                sqlpegainfarma="select tp.id, tc.preco_venda, tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                    "join tprecos tc on tp.id=tc.id\n" +
                     "join tbarras tb on tp.id=tb.id_produto\n" +
                                    " where tb.codigo_barras='"+cod+"'";
            }else{
                sqlpegainfarma="select tp.id, tc.preco_venda, tp.nomelongo,tb.codigo_barras from tprodutos tp\n" +
                                       "join tprecos tc on tp.id=tc.id\n" +
                        "join tbarras tb on tp.id=tb.id_produto\n" +
                                       "where tp.nomelongo='"+nomearma+"'";
               }
        }
       try {
            PreparedStatement psinf= conexao.getPreparedStatementResult(sqlpegainfarma);
            ResultSet rsinf= psinf.executeQuery();
            System.out.println(sqlpegainfarma);
            rsinf.first();
            String id,total,descricao=null;
            Double preco,qnt=0.00;
            id=rsinf.getString(4);
            preco=rsinf.getDouble(2);
            descricao=rsinf.getString(3);
            qnt=Double.parseDouble(cbQtdemunicao.getText().replaceAll(",","."));
            total= clsaux.formato(qnt*preco);
            DefaultTableModel tbarm= (DefaultTableModel) tblArmas.getModel();
            idarma=idarma+1;
            tbarm.addRow(new Object[]{
                id,descricao,qnt,preco,total,idarma
            });
            rsinf.close();
            psinf.close();
            cbQtdemunicao.setText("1");
            cbQtdemunicao.requestFocus();
        } catch (SQLException ex ) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
            gravarLog.main(ex.getMessage().toString());
            JOptionPane.showMessageDialog(null, "Erro ao buscar dados do produto\n Verifique o preço da categoria...\n"+ex.getMessage());
        } catch (NullPointerException nu){
            JOptionPane.showMessageDialog(null, "Erro ao processar categoria de preco...\n\n"+nu.getMessage());
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, nu);
            
        }
        this.calculaValorarma();
    
    }
    public void calculaValorarma(){
        int vlitem=0;
        vlitem=tblArmas.getRowCount();
        Double total=0.00;
        for (int i=0; i<vlitem; i++){
            total=total+Double.parseDouble(tblArmas.getValueAt(i, 4).toString().replaceAll(",", "."));
        }
        lbTotalmun.setText(clsaux.formato(total));
        this.calculaTotal();
        txtCodBarras.requestFocus();
    }
    public void calculaTotal(){
        Double vlarma=Double.parseDouble(lbTotalmun.getText().replace(",", "."));
        Double vlpro= Double.parseDouble(lbTotalitem.getText().replace(",", "."));
        lbTotal.setText(clsaux.formato(vlarma+vlpro));
    }
    public void pegarAtirador(String vlinformado){
        String sqlbusca=null;
        if (clsConfig.localizaporcr.equals("S")){
         sqlbusca="select tp.razao_social, tn.desc_plano, tp.idparceiro,tn.id_plano from tparceiros tp\n" +
"                        left join tplanos_clube tn on tp.id_plano=tn.id_plano\n" +
                        "where tp.cr='"+vlinformado+"';";
        } else {
        sqlbusca="select tp.razao_social, tn.desc_plano, tp.idparceiro,tn.id_plano from tparceiros tp\n" +
"                        left join tplanos_clube tn on tp.id_plano=tn.id_plano\n" +
                        "where tp.idparceiro='"+vlinformado+"';";
        }
        try {
             PreparedStatement psbusca= conexao.getPreparedStatementResult(sqlbusca);
             ResultSet rsbusc= psbusca.executeQuery();
             rsbusc.next();
             String nome,plano,id=null;
             nome=rsbusc.getString(1);
             idcategoria=rsbusc.getString(4);
             if (idcategoria==null){
                 idcategoria="0";
             }
             lbPlano.setText(rsbusc.getString(2));
             idcliente= rsbusc.getString(3);
             rsbusc.close();
             psbusca.close();
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    }
    public void gravarPrevenda(){
        lancamentoTiroDAO lt = new lancamentoTiroDAO();
        clsLancamentoTiro lan= new clsLancamentoTiro();
        String total= lbTotal.getText().replace(",", ".");
        String data=ftData.getText();
        idmvpre= lt.inserirMovto(idcliente, total,data);
        int linhas=tblArmas.getRowCount();
        for (int i=0; i<linhas; i++){
            lan.setIdmovto(idmvpre);
            lan.setBarras(tblArmas.getValueAt(i, 0).toString());
            lan.setQnt(tblArmas.getValueAt(i, 2).toString());
            lan.setVlunitario(tblArmas.getValueAt(i, 3).toString().replaceAll(",", "."));
            lan.setVltotal(tblArmas.getValueAt(i, 4).toString().replaceAll(",","."));
            lan.setTipoitem("A");
            lan.setNum_item(tblArmas.getValueAt(i, 5).toString());
            lt.inserirItensmovto(lan);
        }
        linhas = tblProdutos.getRowCount();
        for(int l=0; l<linhas; l++){
            lan.setIdmovto(idmvpre);
            lan.setBarras(tblProdutos.getValueAt(l, 0).toString());
            lan.setQnt(tblProdutos.getValueAt(l, 2).toString());
            lan.setVlunitario(tblProdutos.getValueAt(l, 3).toString().replaceAll(",", "."));
            lan.setVltotal(tblProdutos.getValueAt(l, 4).toString().replaceAll(",", "."));
            lan.setTipoitem("P");
            lan.setNum_item(tblProdutos.getValueAt(l, 5).toString());
            lt.inserirItensmovto(lan);
        }
        //this.pegaItensImprimir(idmvpre);
        idarma=0;
        idprod=0;
        JOptionPane.showMessageDialog(null, "Inserido com Sucesso!!!");
        this.limpaDadosVenda();
        //lancamentoTiro dialog = new lancamentoTiro(new javax.swing.JFrame(), true);
        //dialog.setVisible(true);
    }
    public void alteraPrevenda(){
        lancamentoTiroDAO lt = new lancamentoTiroDAO();
        clsLancamentoTiro lan= new clsLancamentoTiro();
        String total= lbTotal.getText().replace(",", ".");
        String data=ftData.getText();
        lt.atualizarMovto(txtIdpvenda.getText(), total,data);
        int linhas=tblArmas.getRowCount();
        for (int i=0; i<linhas; i++){
            int posicao=Integer.parseInt(tblArmas.getValueAt(i, 5).toString());
            if (posicao>ultimoarma){
            lan.setIdmovto(txtIdpvenda.getText());
            lan.setBarras(tblArmas.getValueAt(i, 0).toString());
            lan.setQnt(tblArmas.getValueAt(i, 2).toString());
            lan.setVlunitario(tblArmas.getValueAt(i, 3).toString().replaceAll(",", "."));
            lan.setVltotal(tblArmas.getValueAt(i, 4).toString().replaceAll(",", "."));
            lan.setTipoitem("A");
            lan.setNum_item(tblArmas.getValueAt(i, 5).toString());
            lt.inserirItensmovto(lan);
            }
        }
        linhas = tblProdutos.getRowCount();
        for(int l=0; l<linhas; l++){
            int posicao=Integer.parseInt(tblProdutos.getValueAt(l, 5).toString());
            if(posicao>ultimoitem){
            lan.setIdmovto(txtIdpvenda.getText());
            lan.setBarras(tblProdutos.getValueAt(l, 0).toString());
            lan.setQnt(tblProdutos.getValueAt(l, 2).toString());
            lan.setVlunitario(tblProdutos.getValueAt(l, 3).toString().replaceAll(",", "."));
            lan.setVltotal(tblProdutos.getValueAt(l, 4).toString().replaceAll(",", "."));
            lan.setTipoitem("P");
            lan.setNum_item(tblProdutos.getValueAt(l, 5).toString());
            lt.inserirItensmovto(lan);
            }
        }
         //this.pegaItensImprimir(txtIdpvenda.getText());
         idarma=0;
         idprod=0;
        JOptionPane.showMessageDialog(null, "Registro Atualizado com sucesso!!!");
        this.limpaDadosVenda();
        //lancamentoTiro dialog = new lancamentoTiro(new javax.swing.JFrame(), true);
        //dialog.setVisible(true);
    }
    public void carregarAberturaPreVenda(String reserva){
         String sql="select tv.id_prevenda,\n" +
"        tv.idcliente,\n" +
"        tv.total,\n" +
"        sum (iif(ti.tipo_item='A',ti.vl_total,0)) as total_arma,\n" +
"        sum (iif(ti.tipo_item='P',ti.vl_total,0)) as total_item,\n" +
"        tp.cr  \n "
   + "from tpre_venda tv\n" +
" left join titens_prevenda ti on tv.id_prevenda=ti.id_prevenda\n" +
" left join tparceiros tp on tv.idcliente=tp.idparceiro \n"
  + "where tv.id_prevenda='"+reserva+"' and ti.estado='2'\n" +
" group by 1,2,3,6";
        try {
            System.out.println(sql);
             PreparedStatement ps = conexao.getPreparedStatementResult(sql);
             ResultSet rs = ps.executeQuery();
             rs.first();
             if(clsConfig.localizaporcr.equals("S")){
                 txtAtirador.setText(rs.getString(6));
                 this.pegarAtirador(rs.getString(6));
                 this.buscaDadosAtirador();
                 
             }else{
                 txtAtirador.setText(rs.getString(2));
                 this.pegarAtirador(rs.getString(2));
                 this.buscaDadosAtirador();
             }
             lbTotalmun.setText(clsaux.formato(rs.getDouble(4)));
             lbTotalitem.setText(clsaux.formato(rs.getDouble(5)));
             lbTotal.setText(clsaux.formato(rs.getDouble(3)));
             this.carregaItens(reserva);
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
        }
       
    }
    public void carregaItens(String reserv){
        String sqlbu = "select tv.barras,\n" +
"        tp.nomelongo,\n" +
"        tv.qnt,\n" +
"        tv.vl_total,\n" +
"        tv.tipo_item,"
                + "tv.id_item,\n"
                + "tv.valor_unitario" +
" from titens_prevenda tv\n" +
" join tprodutos tp on tv.id_produto=tp.id\n" +
"  where id_prevenda='"+reserv+"' and tv.estado='2'";
       // JOptionPane.showMessageDialog(null, "abre itens");
        try {
             PreparedStatement ps = conexao.getPreparedStatement(sqlbu);
             ResultSet rs = ps.executeQuery();
             DefaultTableModel tblam= (DefaultTableModel) tblArmas.getModel();
             DefaultTableModel tbpr = (DefaultTableModel) tblProdutos.getModel();
             tblam.setNumRows(0);
             tbpr.setNumRows(0);
             clsLancamentoTiro ct= new clsLancamentoTiro();
             while (rs.next()){
                 ct.setIdpro(rs.getString(1));
                 ct.setNomeitem(rs.getString(2));
                 ct.setQnt(rs.getString(3));
                 ct.setVltotal(clsaux.formato(rs.getDouble(4)));
                 ct.setTipoitem(rs.getString(5));
                 ct.setNum_item(rs.getString(6));
                 ct.setVlunitario(rs.getString(7));
                 if (ct.getTipoitem().equals("A")){
                     tblam.addRow(new Object []{
                        ct.getIdpro(),
                        ct.getNomeitem(),
                        ct.getQnt(),
                        ct.getVlunitario(),
                        ct.getVltotal(),
                        ct.getNum_item()
                     });
                        ultimoarma=Integer.parseInt(ct.getNum_item());
                        
                    }
                 else if (ct.getTipoitem().equals("P")){
                     tbpr.addRow(new Object[]{
                        ct.getIdpro(),
                        ct.getNomeitem(),
                        ct.getQnt(),
                        ct.getVlunitario(),
                        ct.getVltotal(),
                        ct.getNum_item()
                     });
                     ultimoitem=Integer.parseInt(ct.getNum_item());
                 }
             }
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
        }
        idarma=ultimoarma;
        idprod=ultimoitem;
        txtCodBarras.requestFocus();
    }
    public void pegaItensImprimir(String idreserva){
        String sql="select tp.id_prevenda,\n" +
"        tp.id_item,\n" +
"        tp.id_produto,\n" +
"        ts.nomelongo,\n" +
"        tp.qnt, tp.tipo_item\n" +
" from titens_prevenda tp\n" +
" join tprodutos ts on tp.id_produto=ts.id\n" +
" where tp.id_prevenda='"+idreserva+"' and tp.impresso is null;";
         try {
             PreparedStatement ps = conexao.getPreparedStatementResult(sql);
             ResultSet rs = ps.executeQuery();
             ArrayList<String> ret= new ArrayList<>();
             while (rs.next()){
                ret.add(rs.getString(1));
                ret.add(rs.getString(2));
                ret.add(rs.getString(3));
                ret.add(rs.getString(4));
                ret.add(rs.getString(5));
                ImpFichaConsumo im = new ImpFichaConsumo(ret);
                this.atualizaItemImpresso(
                rs.getString(1),
                rs.getString(2),
                rs.getString(6)
                );
                ret.clear();
            }
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public void atualizaItemImpresso(String idmv,String iditem,String tipoitem){
        String sql="update titens_prevenda set impresso='S' where\n" +
                    "id_prevenda="+idmv+" and id_item="+iditem+" and tipo_item='"+tipoitem+"';";
        PreparedStatement pd = conexao.getPreparedStatement(sql);
        try {
            pd.executeUpdate();
            pd.close();
        } catch (SQLException ex) {
            Logger.getLogger(lancamentoTiro.class.getName()).log(Level.SEVERE, null, ex);
        }
            
    }
    public void finalizaVenda(){
        System.out.println("inicio funcao finaliza venda");
        lancamentoTiroDAO td = new lancamentoTiroDAO();
        clsLancamentoTiro lt= new clsLancamentoTiro();
        Double totall=totalreserva-desco;
        idmovto=td.inserirMovtoFinalizado(totall.toString(), desco.toString(), idcliente, txtIdpvenda.getText(),ftData.getText(),totalreserva.toString());
        int numerolinhas= tblArmas.getRowCount(),iditem=0;
        for(int i=0;i<numerolinhas; i++){
            iditem=iditem+1;
            lt.setIdmovto(idmovto);
            lt.setBarras(tblArmas.getValueAt(i, 0).toString());
            lt.setQnt(tblArmas.getValueAt(i, 2).toString());
            lt.setVlunitario(tblArmas.getValueAt(i, 3).toString());
            lt.setVltotal(tblArmas.getValueAt(i, 4).toString().replaceAll(",", "."));
            lt.setTipoitem("2");
            lt.setNum_item(String.valueOf(iditem));
            td.inserirItensVenda(lt);
        }
        numerolinhas= tblProdutos.getRowCount();
        for(int l=0; l<numerolinhas;l++){
            iditem=iditem+1;
            lt.setIdmovto(idmovto);
            lt.setBarras(tblProdutos.getValueAt(l, 0).toString());
            lt.setQnt(tblProdutos.getValueAt(l, 2).toString());
            lt.setVlunitario(tblProdutos.getValueAt(l, 3).toString());
            lt.setVltotal(tblProdutos.getValueAt(l, 4).toString().replaceAll(",", "."));
            lt.setTipoitem("2");
            lt.setNum_item(String.valueOf(iditem));
            td.inserirItensVenda(lt);
        }
        iditem=0;
        this.inserePagamentoVenda(idmovto);
        String valida=txtIdpvenda.getText();
        if(clsConfig.imprimeConsumo.equals("S")){
            this.impressaoConsumo();
        }
        if (desco>0.00){
            this.rateioDesconto(desco, idmovto);
        }
        this.limpaDadosVenda();
    }
    public void imprimeItensVendaDireto(){
        int numero=tblArmas.getRowCount();
        ArrayList<String> im= new ArrayList<>();
        for (int i=0; i<numero; i++){
            im.add("0");
            im.add("0");
            im.add(tblArmas.getValueAt(i, 0).toString());
            im.add(tblArmas.getValueAt(i, 1).toString());
            im.add(tblArmas.getValueAt(i, 2).toString());
            System.out.println("chamo funcao imprficaha consumo");
            ImpFichaConsumo ic = new ImpFichaConsumo(im);
            im.clear();
        }
        numero=tblProdutos.getRowCount();
        for(int j=0; j<numero; j++){
            im.add("0");
            im.add("0");
            im.add(tblProdutos.getValueAt(j, 0).toString());
            im.add(tblProdutos.getValueAt(j, 1).toString());
            im.add(tblProdutos.getValueAt(j, 2).toString());
            ImpFichaConsumo ic = new ImpFichaConsumo(im);
            im.clear();
        }
        //ImpFichaConsumo ic = new ImpFichaConsumo(im);
    }
    public void inserePagamentoVenda(String idvenda){
        lancamentoTiroDAO ltd= new lancamentoTiroDAO();
        int vlarray = dadosfinalizadora.size();
        String idfina=null;
        Double valor=0.00;
        Date data= clsaux.retornaData(clsaux.preencheData());
        int parcela=1;
        Double vltroco=0.00;
        for (int b=0; b< vlarray; b++){
            String dados=dadosfinalizadora.get(b).toString();
            idfina=clsaux.retornaId(dados);
            valor=Double.parseDouble(clsaux.retornaAposId(dados).replaceAll(",", "."));
            if (idfina.equals("99")){
                vltroco=Double.parseDouble(valor.toString());
            }
        }
        for (int a=0; a<vlarray; a++){
            String pega=dadosfinalizadora.get(a).toString();
            idfina=clsaux.retornaId(pega);
            valor=Double.parseDouble(clsaux.retornaAposId(pega).replaceAll(",", "."));
            if(idfina.equals("99")){}
            else if (idfina.equals("7")){
                ltd.insereCreditoDireto(idcliente, valor.toString());
                //ltd.insereFinalidoraVenda(idfina, valor.toString(), idvenda,String.valueOf(parcela),0.00);
            }
            else{
                if(idfina.equals("1")){
                    ltd.insereFinalidoraVenda(idfina, valor.toString(), idvenda,String.valueOf(parcela),vltroco,data);
                } else {
                    ltd.insereFinalidoraVenda(idfina, valor.toString(), idvenda,String.valueOf(parcela),0.00,data);
                }
                if (idfina.equals("4")){
                    this.inserirContaReceber(valor.toString());
                    idcliente="";
                }else if (idfina.equals("8")){
                    ltd.rateioValorBaixarPorUsoCredito(idcliente, valor, idmovto,"");
                } else {
                    valor=valor-vltroco;
                    ltd.insereFinanceiroVenda(valor.toString(), idfina,idvenda,ftData.getText(),idcliente);
                    vltroco=0.00;
                }
                parcela++;
            }
        }
    }
    public void inserirContaReceber(String vl){
        ContasReceberDAO cr = new ContasReceberDAO();
        CadContasRecPagar cc= new CadContasRecPagar();
        cc.setIdmovto(idmovto);
        cc.setParceiro(idcliente);
        cc.setValor(vl);
        cc.setNumero("0");
        cc.setEmisao(clsaux.retornaData(clsaux.preencheData()));
        Calendar cd= Calendar.getInstance();
        SimpleDateFormat ft = new SimpleDateFormat("dd/MM/yyyy");
        cd.add(Calendar.MONTH, 1);
        cc.setVencimento(clsaux.retornaData(ft.format(cd.getTime())));
        cc.setEstadotitulo("4");
        cc.setTipo_titulo("1");
        cc.setConta("1");
        cc.setHistorico("1");
        cc.setTipo("2");
        cc.setParcela("1");
        cc.setJuros("0.00");
        cc.setDesconto("0.00");
        cc.setSaldo(vl);
        cc.setBanco("1");
        cc.setVendedor("1");
        cr.inserir(cc);
        idcliente="";
    }
    public void impressaoConsumo(){
        List<ProdutoImpresso> ip= new ArrayList<>();
        int num=tblArmas.getRowCount();
        for (int i=0; i<num; i++){
            ProdutoImpresso item= new ProdutoImpresso(
                tblArmas.getValueAt(i, 4).toString(),
                tblArmas.getValueAt(i, 0).toString(),
                tblArmas.getValueAt(i, 1).toString(),
                tblArmas.getValueAt(i, 3).toString(), 
                tblArmas.getValueAt(i, 2).toString(),
                tblArmas.getValueAt(i, 4).toString()
            );
            ip.add(item);
        }
        num=tblProdutos.getRowCount();
        for(int j=0; j<num; j++){
            ProdutoImpresso item=new ProdutoImpresso(
                    tblProdutos.getValueAt(j, 5).toString(),
                    tblProdutos.getValueAt(j, 0).toString(),
                    tblProdutos.getValueAt(j, 1).toString(),
                    tblProdutos.getValueAt(j, 3).toString(),
                    tblProdutos.getValueAt(j, 2).toString(),
                    tblProdutos.getValueAt(j, 4).toString()
            );
            ip.add(item);
        }
        valorvenda=lbTotal.getText();
        RelacaoDeProdutos rp= new RelacaoDeProdutos(ip);
        rp.imprimir("Cupom", 50, 30);
    }
    public void rateioDesconto(Double vldesconto,String idmovimento){
        if(clsConfig.rateiadescontoitens.equals("S")){
            lancDocumentDAO lc=new lancDocumentDAO();
            lc.realizaRateioDescontoItens(idmovimento, vldesconto);
        }
    }
    public void limpaDadosVenda(){
        idcliente=null;
        idmvpre=null;
        idmovto=null;
        idcategoria="0";
        valorvenda="0,00";
        idarma=0;
        idprod=0;
        ultimoitem=0;
        ultimoarma=0;
        totalreserva=0.00;
        desco=0.00;
        dadosfinalizadora=null;
        lbTotal.setText("0,00");
        lbTotalmun.setText("0,00");
        lbTotalitem.setText("0,00");
        DefaultTableModel tbarm= (DefaultTableModel) tblArmas.getModel();
        tbarm.setNumRows(0);
        DefaultTableModel tbpro= (DefaultTableModel) tblProdutos.getModel();
        tbpro.setNumRows(0);
        txtIdpvenda.setText("0");
        ftData.setText(clsaux.retorDataHora());
        txtAtirador.setText("0");
        lbPlano.setText(null);
        txtSocio.setText("");
        lancamentoTiro.validafinvenda="N";
    }
    public void cancelaItem(String indice,String tp){
        lancamentoTiroDAO lc= new lancamentoTiroDAO();
        lc.cancelamentoItem(idmvpre, indice,tp);
    }
    
    
    
   
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(lancamentoTiro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(lancamentoTiro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(lancamentoTiro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(lancamentoTiro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the dialog */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                lancamentoTiro dialog = new lancamentoTiro(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
           
        });
            
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnConfirma;
    private javax.swing.JButton btnProcuraAtirador;
    private javax.swing.JButton btnRegistrarTiro;
    private javax.swing.JButton btnRegistrarTiro1;
    private javax.swing.JButton btnRegistrarTiro2;
    private javax.swing.JComboBox<String> cbArmasRegistradas;
    private javax.swing.JComboBox<String> cbProdutos;
    private javax.swing.JTextField cbQtdemunicao;
    private javax.swing.JTextField cbQuantidadeproduto;
    private javax.swing.JFormattedTextField ftData;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel2;
    public static javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JSeparator jSeparator5;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel lbCadastroAtirador;
    private javax.swing.JLabel lbExcluieq;
    private javax.swing.JLabel lbExcluirpr;
    private javax.swing.JLabel lbLogo;
    private javax.swing.JLabel lbPlano;
    private javax.swing.JLabel lbPreVenda;
    private javax.swing.JLabel lbTotal;
    private javax.swing.JLabel lbTotalitem;
    private javax.swing.JLabel lbTotalmun;
    private javax.swing.JTable tblArmas;
    private javax.swing.JTable tblProdutos;
    public static javax.swing.JTextField txtAtirador;
    private javax.swing.JTextField txtCodBarras;
    private javax.swing.JTextField txtCodBarrasProd;
    public static javax.swing.JLabel txtIdpvenda;
    public static javax.swing.JTextField txtSocio;
    // End of variables declaration//GEN-END:variables
}
