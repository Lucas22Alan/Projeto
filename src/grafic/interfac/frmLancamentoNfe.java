/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package grafic.interfac;

import DAO.CondicionalDAO;
import grafic.interfac.pesquisa.formProcuraCliente;
import DAO.ContasReceberDAO;
import Logs.gravarLog;
import DAO.MovimentoContaDAO;
import DAO.lancDocumentDAO;
import DAO.lancamentoTiroDAO;
import DAO.listaDAO;
import DAO.nfeDAO;
import DAO.orcamentoDAO;
import DAO.orderServicoDAO;
import model.CadContasRecPagar;
import model.CadDocMovConta;
import model.clsConfig;
import model.clsLancDocCabecalho;
import model.clsLancDocument;
import model.clsNfTransporte;
import model.clsNfe;
import classes.clsaux;
import com.sun.glass.events.KeyEvent;
import conexoes.conexao;
import java.awt.event.ActionEvent;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.AbstractAction;
import javax.swing.DefaultComboBoxModel;
import javax.swing.InputMap;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.table.DefaultTableModel;
import model.clsOrcamento;
import model.clsOrdem;
import model.tnf_infimportacao;


/**
 *
 * @author Rodrigo
 */
public class frmLancamentoNfe extends javax.swing.JDialog {

    /**
     * Creates new form LancamentoDocumentos
     */
    
    
    public static List <clsLancDocument> itens= new ArrayList();
    clsNfe nf= new clsNfe();
    clsNfTransporte transporte= new clsNfTransporte();
    public frmLancamentoNfe(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        this.inicializa();
        txtIdParceiro.requestFocus();
    }
    
   
    
    
    
    public static String idmovimento=null,estadoform="O";
    public static String idmvtoOrigemDuplica="0";
    public static String tipomovto="0";
    public static int numeitem=1;
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        txtMovto = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        txtDocumento = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        ftDatemissao = new javax.swing.JFormattedTextField();
        ftDatlancamento = new javax.swing.JFormattedTextField();
        jLabel5 = new javax.swing.JLabel();
        txtIdParceiro = new javax.swing.JTextField();
        txtRazaoSocial = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        txtSerie = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        cbFibalidade = new javax.swing.JComboBox<>();
        jLabel22 = new javax.swing.JLabel();
        txtCnpj = new javax.swing.JTextField();
        txtChave = new javax.swing.JTextField();
        jLabel23 = new javax.swing.JLabel();
        txtFone = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        txtInscricao = new javax.swing.JTextField();
        jLabel30 = new javax.swing.JLabel();
        cbIndDest = new javax.swing.JComboBox<>();
        cbIe = new javax.swing.JComboBox<>();
        jLabel31 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        cbPresComp = new javax.swing.JComboBox<>();
        jLabel33 = new javax.swing.JLabel();
        cbConsFinal = new javax.swing.JComboBox<>();
        cbControleInterno = new javax.swing.JComboBox<>();
        jLabel34 = new javax.swing.JLabel();
        jLabel49 = new javax.swing.JLabel();
        txtCfop = new javax.swing.JTextField();
        jLabel50 = new javax.swing.JLabel();
        txtModelo = new javax.swing.JTextField();
        btnPesq = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jPanel4 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        txtBaseicms = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        txtValoricms = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        txtBasest = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        txtValorst = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        txtOutdesp = new javax.swing.JTextField();
        jLabel12 = new javax.swing.JLabel();
        txtDescont = new javax.swing.JTextField();
        txtTotalprod = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        txtTotalgeral = new javax.swing.JTextField();
        jLabel35 = new javax.swing.JLabel();
        txtValorPis = new javax.swing.JTextField();
        jLabel36 = new javax.swing.JLabel();
        txtValorCofins = new javax.swing.JTextField();
        jLabel57 = new javax.swing.JLabel();
        txtvlIpi = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel6 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbItens = new javax.swing.JTable();
        btnExcluir = new javax.swing.JButton();
        btnIncluir = new javax.swing.JButton();
        btnAlterar = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jLabel28 = new javax.swing.JLabel();
        CbFinalizadora = new javax.swing.JComboBox();
        CbParcelas = new javax.swing.JComboBox<>();
        btnOk = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblParcelas = new javax.swing.JTable();
        txtValortotaldocumento = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        txtTroco = new javax.swing.JLabel();
        jLabel29 = new javax.swing.JLabel();
        txtValorrecebido = new javax.swing.JTextField();
        btnExluirPag = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        txtidTransportadora = new javax.swing.JTextField();
        jLabel37 = new javax.swing.JLabel();
        jLabel38 = new javax.swing.JLabel();
        txtCnpjTransportadora = new javax.swing.JTextField();
        txtRazaoTransportador = new javax.swing.JTextField();
        jLabel39 = new javax.swing.JLabel();
        txtUfTransportador = new javax.swing.JTextField();
        jLabel40 = new javax.swing.JLabel();
        txtCidadeTRansportador = new javax.swing.JTextField();
        jLabel41 = new javax.swing.JLabel();
        jLabel42 = new javax.swing.JLabel();
        cbModFrete = new javax.swing.JComboBox<>();
        jLabel43 = new javax.swing.JLabel();
        txtPesoLiq = new javax.swing.JTextField();
        jLabel44 = new javax.swing.JLabel();
        txtPesoBruto = new javax.swing.JTextField();
        jLabel45 = new javax.swing.JLabel();
        txtVolume = new javax.swing.JTextField();
        jLabel46 = new javax.swing.JLabel();
        txtEspecie = new javax.swing.JTextField();
        jLabel47 = new javax.swing.JLabel();
        txtnumeros = new javax.swing.JTextField();
        jPanel9 = new javax.swing.JPanel();
        txtChaveAcessoRef = new javax.swing.JTextField();
        jLabel48 = new javax.swing.JLabel();
        btnAdicionaChave = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        tbInfRef = new javax.swing.JTable();
        jLabel56 = new javax.swing.JLabel();
        jScrollPane6 = new javax.swing.JScrollPane();
        txtObservacaoNfe = new javax.swing.JTextArea();
        btnAdicionaChave1 = new javax.swing.JButton();
        jPanel10 = new javax.swing.JPanel();
        jLabel51 = new javax.swing.JLabel();
        cbOrigem = new javax.swing.JComboBox<>();
        jLabel52 = new javax.swing.JLabel();
        txtPercentualImporta = new javax.swing.JTextField();
        jPanel11 = new javax.swing.JPanel();
        jLabel53 = new javax.swing.JLabel();
        txtMovAnexar = new javax.swing.JTextField();
        btnAnexarPorMovimento = new javax.swing.JButton();
        jPanel12 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tbAnexos = new javax.swing.JTable();
        ftDataInicioBusca = new javax.swing.JFormattedTextField();
        ftDataFinalBusca = new javax.swing.JFormattedTextField();
        jLabel54 = new javax.swing.JLabel();
        jLabel55 = new javax.swing.JLabel();
        btnBuscarReg = new javax.swing.JButton();
        btnAnexarMarcado = new javax.swing.JButton();
        jPanel13 = new javax.swing.JPanel();
        jScrollPane5 = new javax.swing.JScrollPane();
        tbAnexosImportar = new javax.swing.JTable();
        btnRemoveAnexos = new javax.swing.JButton();
        btnImportaAnexos = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Visualização de Documento");
        addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                formComponentShown(evt);
            }
        });
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                formWindowClosing(evt);
            }
        });

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jPanel2.setBackground(new java.awt.Color(219, 227, 227));
        jPanel2.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153)));

        txtMovto.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtMovto.setEnabled(false);

        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel1.setText("Id Mov :");

        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel2.setText("Doc. :");

        txtDocumento.setEditable(false);
        txtDocumento.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel3.setText("Emissão :");

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel4.setText("Lançamento :");

        try {
            ftDatemissao.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftDatemissao.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        try {
            ftDatlancamento.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftDatlancamento.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel5.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel5.setText("Parceiro :");

        txtIdParceiro.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtIdParceiro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtIdParceiroActionPerformed(evt);
            }
        });

        txtRazaoSocial.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel6.setText("Serie :");

        txtSerie.setEditable(false);
        txtSerie.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel15.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel15.setText("Finalidade:");

        cbFibalidade.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbFibalidade.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1- Normal", "2- Complementar", "3- Ajuste", "4- Devolução" }));
        cbFibalidade.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbFibalidadeActionPerformed(evt);
            }
        });

        jLabel22.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel22.setText("Cnpj :");

        txtCnpj.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txtChave.setEditable(false);
        txtChave.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel23.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel23.setText("Ie:");

        txtFone.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel24.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel24.setText("Fone :");

        jLabel27.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel27.setText("Chave:");

        txtInscricao.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtInscricao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtInscricaoActionPerformed(evt);
            }
        });

        jLabel30.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel30.setText("Indicador Destino:");

        cbIndDest.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbIndDest.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1- Op Interna", "2- Op  Interestadual", "3- Op Exterior" }));

        cbIe.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbIe.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1- Contribuente", "2- Isento", "9- Outros" }));
        cbIe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbIeActionPerformed(evt);
            }
        });

        jLabel31.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel31.setText("Ind IE:");

        jLabel32.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel32.setText("Ind Presença");

        cbPresComp.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbPresComp.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "0- Nao Aplica", "1- Presencial", "2- Internet", "3- Teleatendimento", "4- Nfce entrega", "9- Outros" }));
        cbPresComp.setSelectedIndex(1);

        jLabel33.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel33.setText("Cons. Final");

        cbConsFinal.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbConsFinal.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "0- Consumo", "1- Revenda" }));

        cbControleInterno.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbControleInterno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbControleInternoActionPerformed(evt);
            }
        });

        jLabel34.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel34.setText("Controle Interno:");

        jLabel49.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel49.setText("CFOP:");

        txtCfop.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtCfop.setText("5102");

        jLabel50.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel50.setText("Mod:");

        txtModelo.setEditable(false);
        txtModelo.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtModelo.setText("55");

        btnPesq.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/procura.png"))); // NOI18N
        btnPesq.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPesqActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel5)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(6, 6, 6)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel27)
                            .addComponent(jLabel1))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(txtChave)
                                .addGroup(jPanel2Layout.createSequentialGroup()
                                    .addComponent(txtCnpj, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGap(18, 18, 18)
                                    .addComponent(jLabel23)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(txtInscricao, javax.swing.GroupLayout.PREFERRED_SIZE, 145, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jLabel31)
                                    .addGap(18, 18, 18)
                                    .addComponent(cbIe, 0, 107, Short.MAX_VALUE)
                                    .addGap(5, 5, 5)))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(txtMovto, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel2)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtDocumento, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtSerie, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel49)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtCfop, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel50)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtModelo, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel4, javax.swing.GroupLayout.Alignment.TRAILING))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(ftDatlancamento, javax.swing.GroupLayout.DEFAULT_SIZE, 89, Short.MAX_VALUE)
                                    .addComponent(ftDatemissao)))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel24)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtFone, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(txtIdParceiro, javax.swing.GroupLayout.PREFERRED_SIZE, 51, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnPesq, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(txtRazaoSocial, javax.swing.GroupLayout.PREFERRED_SIZE, 558, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(7, 7, 7))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel22)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel15)
                                .addGap(18, 18, 18)
                                .addComponent(cbFibalidade, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel30)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(cbIndDest, javax.swing.GroupLayout.PREFERRED_SIZE, 157, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel32)
                            .addComponent(jLabel34))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(cbPresComp, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel33)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(cbConsFinal, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(cbControleInterno, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, Short.MAX_VALUE)))))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel50)
                        .addComponent(txtModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel49)
                        .addComponent(txtCfop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel1)
                        .addComponent(txtMovto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel2)
                        .addComponent(txtDocumento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel3)
                        .addComponent(ftDatemissao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel6)
                        .addComponent(txtSerie, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(ftDatlancamento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtChave, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel27))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel5)
                        .addComponent(txtIdParceiro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtRazaoSocial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnPesq, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel22)
                    .addComponent(txtCnpj, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel23)
                    .addComponent(jLabel24)
                    .addComponent(txtFone, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtInscricao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbIe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel31))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel30)
                    .addComponent(cbIndDest, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel32)
                    .addComponent(cbPresComp, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel33)
                    .addComponent(cbConsFinal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cbFibalidade, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel15)
                    .addComponent(cbControleInterno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel34))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel2Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {btnPesq, txtIdParceiro});

        jPanel3.setBackground(new java.awt.Color(219, 227, 227));
        jPanel3.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153)));

        jButton1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Confirma.png"))); // NOI18N
        jButton1.setText("Gravar");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Cancela.png"))); // NOI18N
        jButton2.setText("Cancelar");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jButton1, jButton2});

        jPanel4.setBackground(new java.awt.Color(251, 186, 194));
        jPanel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(153, 0, 0), new java.awt.Color(153, 0, 0), new java.awt.Color(153, 0, 0), new java.awt.Color(153, 0, 0)));

        jLabel7.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel7.setText("Base Icms :");

        txtBaseicms.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtBaseicms.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtBaseicms.setText("0,00");

        jLabel8.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel8.setText("Valor Icms :");

        txtValoricms.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtValoricms.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtValoricms.setText("0,00");

        jLabel9.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel9.setText("Base ST Icms :");

        txtBasest.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtBasest.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtBasest.setText("0,00");

        jLabel10.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel10.setText("Valor ST Icms :");

        txtValorst.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtValorst.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtValorst.setText("0,00");
        txtValorst.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtValorstFocusLost(evt);
            }
        });

        jLabel11.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel11.setText("Outras Despesas :");

        txtOutdesp.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtOutdesp.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtOutdesp.setText("0,00");
        txtOutdesp.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtOutdespFocusLost(evt);
            }
        });

        jLabel12.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel12.setText("Descontos :");

        txtDescont.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtDescont.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtDescont.setText("0,00");
        txtDescont.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtDescontFocusLost(evt);
            }
        });
        txtDescont.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtDescontActionPerformed(evt);
            }
        });

        txtTotalprod.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtTotalprod.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtTotalprod.setText("0,00");

        jLabel13.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel13.setText("Totais Produtos :");

        jLabel14.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel14.setText("Totais Nota :");

        txtTotalgeral.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtTotalgeral.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtTotalgeral.setText("0,00");

        jLabel35.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel35.setText("Valor Pis:");

        txtValorPis.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtValorPis.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtValorPis.setText("0,00");
        txtValorPis.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtValorPisFocusLost(evt);
            }
        });

        jLabel36.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel36.setText("Valor Cofins :");

        txtValorCofins.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtValorCofins.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtValorCofins.setText("0,00");
        txtValorCofins.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtValorCofinsFocusLost(evt);
            }
        });

        jLabel57.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel57.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel57.setText("Valor IPI:");

        txtvlIpi.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtvlIpi.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtvlIpi.setText("0,00");
        txtvlIpi.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtvlIpiFocusLost(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel7, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel8, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel9, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel57, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtvlIpi)
                    .addComponent(txtBaseicms, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 75, Short.MAX_VALUE)
                    .addComponent(txtValoricms, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtBasest, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtValorst, javax.swing.GroupLayout.Alignment.TRAILING))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel11, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel12, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel35, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel36, javax.swing.GroupLayout.Alignment.TRAILING))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtValorCofins, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtValorPis, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtDescont, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtOutdesp, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel13)
                    .addComponent(jLabel14))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtTotalgeral)
                    .addComponent(txtTotalprod, javax.swing.GroupLayout.DEFAULT_SIZE, 75, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txtBaseicms, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel11)
                    .addComponent(txtOutdesp, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel13)
                    .addComponent(txtTotalprod, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(txtValoricms, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel12)
                    .addComponent(txtDescont, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel14)
                    .addComponent(txtTotalgeral, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel35)
                        .addComponent(txtValorPis, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel9)
                        .addComponent(txtBasest, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel36)
                        .addComponent(txtValorCofins, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel10)
                        .addComponent(txtValorst, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel57)
                    .addComponent(txtvlIpi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153), new java.awt.Color(0, 0, 153)));

        jTabbedPane1.setBackground(new java.awt.Color(219, 227, 227));
        jTabbedPane1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jPanel6.setBackground(new java.awt.Color(219, 227, 227));

        tbItens.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        tbItens.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Id Item", "Codigo", "Descrição", "Qtde", "Unidade", "Preço Unit", "Desconto", "Acresc", "Total", "CFOP", "Cst"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbItens.setColumnSelectionAllowed(true);
        tbItens.setRowHeight(20);
        tbItens.getTableHeader().setReorderingAllowed(false);
        jScrollPane1.setViewportView(tbItens);
        tbItens.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        if (tbItens.getColumnModel().getColumnCount() > 0) {
            tbItens.getColumnModel().getColumn(0).setPreferredWidth(10);
            tbItens.getColumnModel().getColumn(1).setMinWidth(50);
            tbItens.getColumnModel().getColumn(1).setPreferredWidth(50);
            tbItens.getColumnModel().getColumn(2).setPreferredWidth(250);
            tbItens.getColumnModel().getColumn(3).setPreferredWidth(10);
            tbItens.getColumnModel().getColumn(4).setPreferredWidth(10);
            tbItens.getColumnModel().getColumn(5).setPreferredWidth(5);
            tbItens.getColumnModel().getColumn(6).setPreferredWidth(5);
            tbItens.getColumnModel().getColumn(7).setPreferredWidth(5);
            tbItens.getColumnModel().getColumn(8).setPreferredWidth(10);
            tbItens.getColumnModel().getColumn(9).setPreferredWidth(10);
            tbItens.getColumnModel().getColumn(10).setPreferredWidth(50);
        }

        btnExcluir.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        btnExcluir.setText("Exluir");
        btnExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirActionPerformed(evt);
            }
        });

        btnIncluir.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        btnIncluir.setText("Incluir");
        btnIncluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIncluirActionPerformed(evt);
            }
        });

        btnAlterar.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        btnAlterar.setText("Alterar");
        btnAlterar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAlterarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 1256, Short.MAX_VALUE)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(btnIncluir)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnAlterar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnExcluir)
                        .addGap(0, 0, Short.MAX_VALUE))))
        );

        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnAlterar, btnExcluir, btnIncluir});

        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnIncluir)
                    .addComponent(btnExcluir)
                    .addComponent(btnAlterar))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Produtos", jPanel6);

        jPanel7.setBackground(new java.awt.Color(219, 227, 227));
        jPanel7.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                jPanel7ComponentShown(evt);
            }
        });

        jLabel28.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jLabel28.setText("Finalizadora :");

        CbFinalizadora.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        CbFinalizadora.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbFinalizadoraActionPerformed(evt);
            }
        });

        CbParcelas.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        CbParcelas.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1", "2", "3", "4", "5" }));
        CbParcelas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbParcelasActionPerformed(evt);
            }
        });

        btnOk.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btnOk.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Incluir.png"))); // NOI18N
        btnOk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnOkActionPerformed(evt);
            }
        });

        tblParcelas.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Data", "Valor", "Id Finalizadora", "Parcela", "Finalizadora"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                true, true, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblParcelas.getTableHeader().setReorderingAllowed(false);
        jScrollPane2.setViewportView(tblParcelas);
        if (tblParcelas.getColumnModel().getColumnCount() > 0) {
            tblParcelas.getColumnModel().getColumn(3).setResizable(false);
            tblParcelas.getColumnModel().getColumn(4).setResizable(false);
        }

        txtValortotaldocumento.setFont(new java.awt.Font("Arial", 1, 16)); // NOI18N
        txtValortotaldocumento.setForeground(new java.awt.Color(255, 51, 0));
        txtValortotaldocumento.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        txtValortotaldocumento.setText("0,00");

        jLabel25.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jLabel25.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel25.setText("   Total R$:");

        jLabel26.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jLabel26.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel26.setText(" Troco R$:");

        txtTroco.setFont(new java.awt.Font("Arial", 1, 16)); // NOI18N
        txtTroco.setForeground(new java.awt.Color(255, 0, 51));
        txtTroco.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        txtTroco.setText("0,00");

        jLabel29.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jLabel29.setText("Valor R$:");

        btnExluirPag.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Deletar.png"))); // NOI18N
        btnExluirPag.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExluirPagActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel28)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbFinalizadora, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(CbParcelas, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel29)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtValorrecebido, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel26, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtTroco, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(btnOk, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnExluirPag, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel25, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtValortotaldocumento, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(665, 665, 665))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel28)
                        .addComponent(CbFinalizadora, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(CbParcelas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel29))
                    .addComponent(btnOk, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtValorrecebido, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnExluirPag))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel25)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtValortotaldocumento)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel26)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtTroco))
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 189, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(121, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Financeiro", jPanel7);

        jPanel8.setBackground(new java.awt.Color(219, 227, 227));

        txtidTransportadora.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtidTransportadora.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtidTransportadora.setText("0");
        txtidTransportadora.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtidTransportadoraFocusLost(evt);
            }
        });
        txtidTransportadora.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtidTransportadoraActionPerformed(evt);
            }
        });

        jLabel37.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel37.setText("Id:");

        jLabel38.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel38.setText("Cnpj:");

        txtCnpjTransportadora.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtCnpjTransportadora.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtCnpjTransportadora.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtCnpjTransportadoraFocusLost(evt);
            }
        });

        txtRazaoTransportador.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtRazaoTransportador.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtRazaoTransportador.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtRazaoTransportadorFocusLost(evt);
            }
        });

        jLabel39.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel39.setText("Razão Social:");

        txtUfTransportador.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtUfTransportador.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtUfTransportador.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtUfTransportadorFocusLost(evt);
            }
        });
        txtUfTransportador.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtUfTransportadorActionPerformed(evt);
            }
        });

        jLabel40.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel40.setText("Uf:");

        txtCidadeTRansportador.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtCidadeTRansportador.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtCidadeTRansportador.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtCidadeTRansportadorFocusLost(evt);
            }
        });
        txtCidadeTRansportador.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCidadeTRansportadorActionPerformed(evt);
            }
        });

        jLabel41.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel41.setText("Cidade:");

        jLabel42.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel42.setText("Mod. Frete:");

        cbModFrete.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbModFrete.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "0- Emitente", "1- Destinatario", "2- Terceiros", "3- Propio Emitente", "4- Propio Destinatario", "9- Sem Frete" }));
        cbModFrete.setSelectedIndex(5);

        jLabel43.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel43.setText("Peso Liq:");

        txtPesoLiq.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtPesoLiq.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtPesoLiq.setText("0,00");
        txtPesoLiq.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtPesoLiqFocusLost(evt);
            }
        });
        txtPesoLiq.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPesoLiqActionPerformed(evt);
            }
        });

        jLabel44.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel44.setText("Peso Bruto:");

        txtPesoBruto.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtPesoBruto.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtPesoBruto.setText("0,00");
        txtPesoBruto.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtPesoBrutoFocusLost(evt);
            }
        });
        txtPesoBruto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPesoBrutoActionPerformed(evt);
            }
        });

        jLabel45.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel45.setText("Volumes:");

        txtVolume.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtVolume.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtVolume.setText("0");
        txtVolume.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtVolumeFocusLost(evt);
            }
        });
        txtVolume.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtVolumeActionPerformed(evt);
            }
        });

        jLabel46.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel46.setText("Especie:");

        txtEspecie.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtEspecie.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtEspecie.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtEspecieFocusLost(evt);
            }
        });
        txtEspecie.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtEspecieActionPerformed(evt);
            }
        });

        jLabel47.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel47.setText("Numeros:");

        txtnumeros.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtnumeros.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtnumeros.setText("0");
        txtnumeros.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtnumerosFocusLost(evt);
            }
        });
        txtnumeros.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtnumerosActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel37)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtidTransportadora, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel38)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtCnpjTransportadora, javax.swing.GroupLayout.PREFERRED_SIZE, 143, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel39))
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel40)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtUfTransportador, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel41)
                                .addGap(18, 18, 18)
                                .addComponent(txtCidadeTRansportador)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtRazaoTransportador, javax.swing.GroupLayout.PREFERRED_SIZE, 389, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel42)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbModFrete, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel46, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtEspecie, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel47, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel43)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtPesoLiq, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel44)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(txtPesoBruto, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel45)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtVolume, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(txtnumeros, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(524, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel37)
                    .addComponent(txtidTransportadora, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel38)
                    .addComponent(jLabel39)
                    .addComponent(txtRazaoTransportador, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtCnpjTransportadora, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel40)
                    .addComponent(txtUfTransportador, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel41)
                    .addComponent(txtCidadeTRansportador, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel42)
                    .addComponent(cbModFrete, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel43)
                    .addComponent(txtPesoLiq, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel44)
                    .addComponent(txtPesoBruto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel45)
                    .addComponent(txtVolume, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel47)
                        .addComponent(txtnumeros, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel46)
                        .addComponent(txtEspecie, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(217, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Transportadora", jPanel8);

        jPanel9.setBackground(new java.awt.Color(219, 227, 227));

        txtChaveAcessoRef.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtChaveAcessoRef.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtChaveAcessoRef.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtChaveAcessoRefFocusLost(evt);
            }
        });

        jLabel48.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel48.setText("Chave Acesso:");

        btnAdicionaChave.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnAdicionaChave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/adicionar.png"))); // NOI18N
        btnAdicionaChave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAdicionaChaveActionPerformed(evt);
            }
        });

        tbInfRef.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Chave Acesso"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane3.setViewportView(tbInfRef);
        if (tbInfRef.getColumnModel().getColumnCount() > 0) {
            tbInfRef.getColumnModel().getColumn(0).setResizable(false);
            tbInfRef.getColumnModel().getColumn(0).setPreferredWidth(300);
        }

        jLabel56.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel56.setText("Observação:");

        jScrollPane6.setViewportBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jScrollPane6.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txtObservacaoNfe.setColumns(20);
        txtObservacaoNfe.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtObservacaoNfe.setLineWrap(true);
        txtObservacaoNfe.setRows(5);
        jScrollPane6.setViewportView(txtObservacaoNfe);

        btnAdicionaChave1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnAdicionaChave1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/Deletar.png"))); // NOI18N
        btnAdicionaChave1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAdicionaChave1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jScrollPane3)
                        .addGap(49, 49, 49))
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addComponent(jLabel48)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtChaveAcessoRef, javax.swing.GroupLayout.PREFERRED_SIZE, 345, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnAdicionaChave, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnAdicionaChave1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(48, 48, 48)))
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel56)
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 451, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(247, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnAdicionaChave, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnAdicionaChave1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel48)
                        .addComponent(txtChaveAcessoRef, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel56)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE)
                    .addComponent(jScrollPane6))
                .addGap(44, 44, 44))
        );

        jTabbedPane1.addTab("Informação Refrenciada", jPanel9);

        jPanel10.setBackground(new java.awt.Color(219, 227, 227));

        jLabel51.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel51.setText("Origem:");

        cbOrigem.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbOrigem.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1- Nfce", "2- Condicional", "3- Orcamento/Pedido", "4- Ordem Servico" }));

        jLabel52.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel52.setText("Percentual:");

        txtPercentualImporta.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txtPercentualImporta.setText("100");

        jPanel11.setBackground(new java.awt.Color(219, 227, 227));
        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED), "Localizar Por Id", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        jLabel53.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel53.setText("Movimento:");

        txtMovAnexar.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        btnAnexarPorMovimento.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnAnexarPorMovimento.setText("Anexar");
        btnAnexarPorMovimento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAnexarPorMovimentoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnAnexarPorMovimento)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel53)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtMovAnexar, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(0, 15, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel53)
                    .addComponent(txtMovAnexar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnAnexarPorMovimento)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel12.setBackground(new java.awt.Color(219, 227, 227));
        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Anexar Por Lote", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        tbAnexos.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        tbAnexos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "[ X ]", "Mvto", "Valor", "Data", "Parceiro", "Chave"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Boolean.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                true, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbAnexos.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        tbAnexos.setRowHeight(20);
        jScrollPane4.setViewportView(tbAnexos);
        if (tbAnexos.getColumnModel().getColumnCount() > 0) {
            tbAnexos.getColumnModel().getColumn(0).setResizable(false);
            tbAnexos.getColumnModel().getColumn(0).setPreferredWidth(30);
            tbAnexos.getColumnModel().getColumn(1).setResizable(false);
            tbAnexos.getColumnModel().getColumn(1).setPreferredWidth(100);
            tbAnexos.getColumnModel().getColumn(2).setResizable(false);
            tbAnexos.getColumnModel().getColumn(2).setPreferredWidth(150);
            tbAnexos.getColumnModel().getColumn(3).setResizable(false);
            tbAnexos.getColumnModel().getColumn(3).setPreferredWidth(80);
            tbAnexos.getColumnModel().getColumn(4).setResizable(false);
            tbAnexos.getColumnModel().getColumn(4).setPreferredWidth(200);
            tbAnexos.getColumnModel().getColumn(5).setResizable(false);
            tbAnexos.getColumnModel().getColumn(5).setPreferredWidth(200);
        }

        try {
            ftDataInicioBusca.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftDataInicioBusca.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ftDataInicioBuscaActionPerformed(evt);
            }
        });

        try {
            ftDataFinalBusca.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftDataFinalBusca.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ftDataFinalBuscaActionPerformed(evt);
            }
        });

        jLabel54.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel54.setText("Inicio:");

        jLabel55.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel55.setText("Final:");

        btnBuscarReg.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnBuscarReg.setText("Buscar Registros");
        btnBuscarReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBuscarRegActionPerformed(evt);
            }
        });

        btnAnexarMarcado.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnAnexarMarcado.setText("Anexar Marcados");
        btnAnexarMarcado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAnexarMarcadoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGap(1, 1, 1)
                .addComponent(jLabel54)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(ftDataInicioBusca, javax.swing.GroupLayout.DEFAULT_SIZE, 80, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addComponent(jLabel55)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(ftDataFinalBusca, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnBuscarReg)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnAnexarMarcado))
            .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 514, Short.MAX_VALUE)
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ftDataInicioBusca, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ftDataFinalBusca, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel54)
                    .addComponent(jLabel55)
                    .addComponent(btnBuscarReg)
                    .addComponent(btnAnexarMarcado))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
        );

        jPanel13.setBackground(new java.awt.Color(219, 227, 227));
        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Registros Anexados Para Importar", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        tbAnexosImportar.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        tbAnexosImportar.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mvto", "Tipo", "Percentual", "Chave"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbAnexosImportar.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        tbAnexosImportar.setRowHeight(20);
        jScrollPane5.setViewportView(tbAnexosImportar);
        if (tbAnexosImportar.getColumnModel().getColumnCount() > 0) {
            tbAnexosImportar.getColumnModel().getColumn(0).setResizable(false);
            tbAnexosImportar.getColumnModel().getColumn(0).setPreferredWidth(100);
            tbAnexosImportar.getColumnModel().getColumn(1).setResizable(false);
            tbAnexosImportar.getColumnModel().getColumn(1).setPreferredWidth(150);
            tbAnexosImportar.getColumnModel().getColumn(2).setResizable(false);
            tbAnexosImportar.getColumnModel().getColumn(2).setPreferredWidth(80);
            tbAnexosImportar.getColumnModel().getColumn(3).setResizable(false);
            tbAnexosImportar.getColumnModel().getColumn(3).setPreferredWidth(150);
        }

        btnRemoveAnexos.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnRemoveAnexos.setText("Remover Todos");
        btnRemoveAnexos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRemoveAnexosActionPerformed(evt);
            }
        });

        btnImportaAnexos.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        btnImportaAnexos.setText("Importar Anexados");
        btnImportaAnexos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnImportaAnexosActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addComponent(btnRemoveAnexos)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnImportaAnexos))
                    .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 334, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnRemoveAnexos)
                    .addComponent(btnImportaAnexos))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 238, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(jLabel51)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(cbOrigem, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel52)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtPercentualImporta, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(127, Short.MAX_VALUE))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel51)
                    .addComponent(cbOrigem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel52)
                    .addComponent(txtPercentualImporta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        jTabbedPane1.addTab("Importar", jPanel10);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1271, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 381, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(120, 120, 120))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 1326, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 24, Short.MAX_VALUE))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnOkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnOkActionPerformed
        this.calculaValoresFinanceiro();
        this.insereFinalizadora(txtMovto.getText());
    }//GEN-LAST:event_btnOkActionPerformed

    private void CbFinalizadoraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbFinalizadoraActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_CbFinalizadoraActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
       this.limpaDados();
        this.dispose();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void txtIdParceiroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtIdParceiroActionPerformed
        this.preencheDadosParceiro(txtIdParceiro.getText());
    }//GEN-LAST:event_txtIdParceiroActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        this.validaDados();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void cbFibalidadeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbFibalidadeActionPerformed
        frmLancamentoNfe.tipomovto=clsaux.retornaId(cbFibalidade.getSelectedItem().toString().trim());
    }//GEN-LAST:event_cbFibalidadeActionPerformed

    private void formComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_formComponentShown
        if (estadoform.equals("I")){
            this.dadosInsercao();
        }else if (estadoform.equals("A")){
            this.carregaDadosAlterar(idmovimento);
            
        }else if(estadoform.equals("D")){
            this.dadosInsercao();
            String idtemp=idmovimento;
            idmovimento=idmvtoOrigemDuplica;
            this.carregaDadosAlterar(idmvtoOrigemDuplica);
            idmovimento=idtemp;
            txtMovto.setText(idmovimento);
            txtDocumento.setText("");
        }
        
    }//GEN-LAST:event_formComponentShown

    private void jPanel7ComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_jPanel7ComponentShown
       this.carregaInfFinanceiro();
    }//GEN-LAST:event_jPanel7ComponentShown

    private void CbParcelasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbParcelasActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_CbParcelasActionPerformed

    private void txtOutdespFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtOutdespFocusLost
        frmLancamentoNfe.calculaTotalDoc();
    }//GEN-LAST:event_txtOutdespFocusLost

    private void txtDescontFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtDescontFocusLost
       frmLancamentoNfe.calculaTotalDoc();
    }//GEN-LAST:event_txtDescontFocusLost

    private void txtValorstFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtValorstFocusLost
        frmLancamentoNfe.calculaTotalDoc();
    }//GEN-LAST:event_txtValorstFocusLost

    private void btnExluirPagActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExluirPagActionPerformed
        this.excluiFinalizadora();
    }//GEN-LAST:event_btnExluirPagActionPerformed

    private void txtInscricaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtInscricaoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtInscricaoActionPerformed

    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing
     this.limpaDados();
    }//GEN-LAST:event_formWindowClosing

    private void cbIeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbIeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbIeActionPerformed

    private void cbControleInternoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbControleInternoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbControleInternoActionPerformed

    private void txtValorPisFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtValorPisFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtValorPisFocusLost

    private void txtValorCofinsFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtValorCofinsFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtValorCofinsFocusLost

    private void txtidTransportadoraFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtidTransportadoraFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtidTransportadoraFocusLost

    private void txtCnpjTransportadoraFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtCnpjTransportadoraFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCnpjTransportadoraFocusLost

    private void txtRazaoTransportadorFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtRazaoTransportadorFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtRazaoTransportadorFocusLost

    private void txtidTransportadoraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtidTransportadoraActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtidTransportadoraActionPerformed

    private void txtUfTransportadorFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtUfTransportadorFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtUfTransportadorFocusLost

    private void txtUfTransportadorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtUfTransportadorActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtUfTransportadorActionPerformed

    private void txtCidadeTRansportadorFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtCidadeTRansportadorFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCidadeTRansportadorFocusLost

    private void txtCidadeTRansportadorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCidadeTRansportadorActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCidadeTRansportadorActionPerformed

    private void txtPesoLiqFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtPesoLiqFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPesoLiqFocusLost

    private void txtPesoLiqActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPesoLiqActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPesoLiqActionPerformed

    private void txtPesoBrutoFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtPesoBrutoFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPesoBrutoFocusLost

    private void txtPesoBrutoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPesoBrutoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPesoBrutoActionPerformed

    private void txtVolumeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtVolumeFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtVolumeFocusLost

    private void txtVolumeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtVolumeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtVolumeActionPerformed

    private void txtEspecieFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtEspecieFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtEspecieFocusLost

    private void txtEspecieActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtEspecieActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtEspecieActionPerformed

    private void txtnumerosFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtnumerosFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtnumerosFocusLost

    private void txtnumerosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtnumerosActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtnumerosActionPerformed

    private void txtChaveAcessoRefFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtChaveAcessoRefFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtChaveAcessoRefFocusLost

    private void btnAdicionaChaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAdicionaChaveActionPerformed
        this.adicinaChave();
    }//GEN-LAST:event_btnAdicionaChaveActionPerformed

    private void txtDescontActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDescontActionPerformed
        this.rateiaDescontoTotalItens();
    }//GEN-LAST:event_txtDescontActionPerformed

    private void btnAnexarPorMovimentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAnexarPorMovimentoActionPerformed
        this.anexarPorId();
    }//GEN-LAST:event_btnAnexarPorMovimentoActionPerformed

    private void btnBuscarRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBuscarRegActionPerformed
       this.buscarPorLote();
    }//GEN-LAST:event_btnBuscarRegActionPerformed

    private void btnAnexarMarcadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAnexarMarcadoActionPerformed
      this.anexarMarcadosLote();
    }//GEN-LAST:event_btnAnexarMarcadoActionPerformed

    private void btnImportaAnexosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImportaAnexosActionPerformed
      this.importaRegistosAnexados();
    }//GEN-LAST:event_btnImportaAnexosActionPerformed

    private void btnRemoveAnexosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRemoveAnexosActionPerformed
       this.limpaRegistrosAnexados();
    }//GEN-LAST:event_btnRemoveAnexosActionPerformed

    private void ftDataInicioBuscaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ftDataInicioBuscaActionPerformed
       ftDataFinalBusca.requestFocus();
    }//GEN-LAST:event_ftDataInicioBuscaActionPerformed

    private void ftDataFinalBuscaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ftDataFinalBuscaActionPerformed
       btnBuscarReg.requestFocus();
    }//GEN-LAST:event_ftDataFinalBuscaActionPerformed

    private void btnPesqActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPesqActionPerformed
        formProcuraCliente dialo = new formProcuraCliente(new javax.swing.JFrame(), true);
                formProcuraCliente.idform="9";
                dialo.setVisible(true);
    }//GEN-LAST:event_btnPesqActionPerformed

    private void txtvlIpiFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtvlIpiFocusLost
        // TODO add your handling code here:
    }//GEN-LAST:event_txtvlIpiFocusLost

    private void btnAdicionaChave1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAdicionaChave1ActionPerformed
       removeChave();
    }//GEN-LAST:event_btnAdicionaChave1ActionPerformed

    private void btnIncluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIncluirActionPerformed
       this.informacoesNfe();
        frmLancamentoItemNfe dialog = new frmLancamentoItemNfe(new javax.swing.JFrame(), true);
        frmLancamentoItemNfe.item=preparaNovoItem();
        frmLancamentoItemNfe.estadoform="O";
        dialog.inicializa(nf, clsaux.retornaId(cbControleInterno.getSelectedItem()));
        dialog.setVisible(true);
    }//GEN-LAST:event_btnIncluirActionPerformed

    private void btnAlterarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAlterarActionPerformed
       this.alteraItem();
    }//GEN-LAST:event_btnAlterarActionPerformed

    private void btnExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirActionPerformed
       this.excluiItem();
    }//GEN-LAST:event_btnExcluirActionPerformed
    public void inicializa(){
        DefaultComboBoxModel cbtip= new DefaultComboBoxModel(listaDAO.listaTipoDocumento().toArray());
        cbControleInterno.setModel(cbtip); 
        InputMap imp= this.getRootPane().getInputMap(JPanel.WHEN_IN_FOCUSED_WINDOW);
        imp.put(KeyStroke.getKeyStroke(KeyEvent.VK_F10,0),"busca");
        imp.put(KeyStroke.getKeyStroke(KeyEvent.VK_F1,0) , "NovoItem");
        imp.put(KeyStroke.getKeyStroke(KeyEvent.VK_F6,0) , "gravar");
        this.getRootPane().setInputMap(JPanel.WHEN_IN_FOCUSED_WINDOW, imp);
        this.getRootPane().getActionMap().put("busca", new AbstractAction(){
            public void actionPerformed(ActionEvent ev){
                formProcuraCliente dialo = new formProcuraCliente(new javax.swing.JFrame(), true);
                formProcuraCliente.idform="9";
                dialo.setVisible(true);
            }
        });
        this.getRootPane().getActionMap().put("NovoItem", new AbstractAction(){
            public void actionPerformed(ActionEvent ev){
                informacoesNfe();
                frmLancamentoItemNfe dialog = new frmLancamentoItemNfe(new javax.swing.JFrame(), true);
                frmLancamentoItemNfe.item=preparaNovoItem();
                frmLancamentoItemNfe.estadoform="O";
                dialog.inicializa(nf, clsaux.retornaId(cbControleInterno.getSelectedItem()));
                dialog.setVisible(true);
            }
        });
       
        this.getRootPane().getActionMap().put("gravar", new AbstractAction(){
            public void actionPerformed(ActionEvent ev){
                validaDados();
            }
        });
    }
    public void dadosInsercao(){
        ftDatemissao.setText(clsaux.preencheData());
        ftDatlancamento.setText(clsaux.preencheData());
        idmovimento=lancDocumentDAO.insereRegistroBranco("0");
        txtMovto.setText(idmovimento);
        txtSerie.setText(clsConfig.configuracaogeral.getSerienfe());
        
    }
    public void preencheDadosParceiro(String id){
        String sql="select tp.idparceiro,\n" +
                    "        tp.cnpj,\n" +
                    "        tp.razao_social,\n" +
                    "        tp.inscricao_estadual,\n" +
                    "        tp.fone from\n" +
                    " tparceiros tp where tp.idparceiro=?";
        PreparedStatement ps = conexao.getPreparedStatementResult(sql);
        try {
            ps.setString(1, id);
            ResultSet rs = ps.executeQuery();
            rs.first();
            txtRazaoSocial.setText(rs.getString(3));
            txtCnpj.setText(rs.getString(2));
            txtInscricao.setText(rs.getString(4));
            txtFone.setText(rs.getString(5));
            rs.close();
            ps.close();
        } catch (SQLException ex) {
            Logger.getLogger(frmLancamentoNfe.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(null, "Erro ao buscar dados do parceiro... \n"+ex.getMessage());
        }
       if(clsaux.trataCampoNuloConfig(nf.getIdentificado()).equals("S")){
           txtCnpj.setText(nf.getCfp());
           txtRazaoSocial.setText(nf.getRazao_social());
           txtCnpj.setEditable(true);
       }
        
    }
    public void gravaRegistro(){
        clsLancDocCabecalho cd= new clsLancDocCabecalho();
        lancDocumentDAO ldDAO= new lancDocumentDAO();
        cd.setIdmovimento(txtMovto.getText());
        cd.setDocument(txtDocumento.getText());
        cd.setSerie(txtSerie.getText());
        cd.setEmissao(clsaux.retornaData(ftDatemissao.getText()));
        cd.setLancamento(clsaux.retornaData(ftDatlancamento.getText()));
        cd.setIdparceiro(txtIdParceiro.getText());
        cd.setBaseicms(txtBaseicms.getText().replaceAll(",", "."));
        cd.setValoricms(txtValoricms.getText().replaceAll(",", "."));
        cd.setBasest(txtBasest.getText().replaceAll(",", "."));
        cd.setValorst(txtValorst.getText().replaceAll(",", "."));
        cd.setOutrasdesp(txtOutdesp.getText().replaceAll(",", "."));
        cd.setDesconto(txtDescont.getText().replaceAll(",", "."));
        cd.setTotalprod(txtTotalprod.getText().replaceAll(",", "."));
        cd.setTotal(txtTotalgeral.getText().replaceAll(",", "."));
        cd.setCfop(txtCfop.getText());
        cd.setChaveacesso(txtChave.getText());
        cd.setTipomovimento(clsaux.retornaId(cbControleInterno.getSelectedItem().toString()));
        cd.setValor_pis(clsaux.capturaValor(txtValorPis.getText()));
        cd.setValor_cofins(clsaux.capturaValor(txtValorCofins.getText()));
        cd.setValoripi(clsaux.capturaValor(txtvlIpi.getText()));
        cd.setModelo(txtModelo.getText());
        ldDAO.atualizaRegistroMovto(cd);
        
        this.gravarItens();
        this.gravarNfe();
        this.gravarTransportadora();
        this.gravarInfReferencia();
        this.limpaDados();
        CRUDNfe.JcbEstado.setSelectedIndex(4);
        CRUDNfe.btnPesquisa.requestFocus();
       
        this.dispose();
    }
    
    public void informacoesNfe(){
       nf.setId_movimento(idmovimento);
       nf.setCstat("0");
       nf.setConsfinal(clsaux.retornaId(cbConsFinal.getSelectedItem().toString()));
       nf.setFinalidade(clsaux.retornaId(cbFibalidade.getSelectedItem().toString()));
       nf.setInddest(clsaux.retornaId(cbIndDest.getSelectedItem().toString()));
       nf.setIndie(clsaux.retornaId(cbIe.getSelectedItem().toString()));
       nf.setPrescomp(clsaux.retornaId(cbPresComp.getSelectedItem().toString()));
    }
    public void gravarNfe(){
       this.informacoesNfe();
       nf.setObservacaoNf(txtObservacaoNfe.getText());
       if(clsaux.trataCampoNuloConfig(nf.getIdentificado()).equals("S")){
           nf.setCfp(txtCnpj.getText());
           nf.setRazao_social(txtRazaoSocial.getText());
       }else{
           nf.setIdentificado("N");
       }
       nfeDAO nfdao= new nfeDAO();
       nfdao.inserirMovimentoNfe(nf);
    }
    public void gravarTransportadora(){
        transporte.setIdmovimento(idmovimento);
        transporte.setCidade(txtCidadeTRansportador.getText());
        transporte.setCnpj(txtCnpjTransportadora.getText());
        transporte.setEspecie(txtEspecie.getText());
        transporte.setIdtranspprtadora(clsaux.trataCampoNulo(txtidTransportadora.getText()));
        transporte.setModfrete(clsaux.retornaId(cbModFrete.getSelectedItem().toString()));
        transporte.setNumero(txtnumeros.getText());
        transporte.setPesobruto(clsaux.capturaValor(txtPesoBruto.getText()));
        transporte.setPesoliq(clsaux.capturaValor(txtPesoLiq.getText()));
        transporte.setRazao(txtRazaoTransportador.getText());
        transporte.setUf(txtUfTransportador.getText());
        transporte.setVolumes(txtVolume.getText());
        nfeDAO.inserirAtualizaTransporteNf(transporte);
   }
    public void gravarInfReferencia(){
        for(int i=0; i<tbInfRef.getRowCount(); i++){
           nfeDAO.gravaInfReferencia(idmovimento, tbInfRef.getValueAt(i, 0).toString());
        }
    }
    public void gravarItens(){
        lancDocumentDAO ldDAO= new lancDocumentDAO();
        for (int i=0; i< itens.size(); i++){
            itens.get(i).setIdmovto(txtMovto.getText());
            ldDAO.insereItensReferenteMovto(itens.get(i));
        }
    }
    public static void calculaTotalDoc(){
        int lin=tbItens.getRowCount();
        Double valor=0.00,total=0.00;
        Double desconto=0.00;
        Double acres=0.00,outrasdesp=0.00,icmsst=0.00,vlpis=0.00,vlcofins=0.00;
        Double vlipi=0.00;
        for (int i=0; i<lin; i++){
            valor=valor+(clsaux.capturaValores(tbItens.getValueAt(i, 5).toString())*clsaux.capturaValores(tbItens.getValueAt(i, 3).toString()));
            desconto=desconto+clsaux.capturaValores(tbItens.getValueAt(i, 6).toString().replaceAll(",", "."));
            acres=acres+clsaux.capturaValores(tbItens.getValueAt(i, 7).toString().replaceAll(",", "."));
            vlpis=vlpis+clsaux.capturaValores(itens.get(i).getValor_pis());
            vlcofins=vlcofins+ clsaux.capturaValores(itens.get(i).getValor_cofins());
            vlipi=vlipi+clsaux.capturaValores(itens.get(i).getValor_ipi());
        }
        txtTotalprod.setText(clsaux.formato(valor));
        txtDescont.setText(clsaux.formato(desconto));
        txtOutdesp.setText(clsaux.formato(acres));
        txtValorPis.setText(clsaux.formato(vlpis));
        txtValorCofins.setText(clsaux.formato(vlcofins));
        txtvlIpi.setText(clsaux.formato(vlipi));
        total=valor+icmsst-desconto+acres+vlipi;
        txtTotalgeral.setText(clsaux.formato(total));
        txtValortotaldocumento.setText(clsaux.formato(total));
    }
    
    public void rateiaDescontoTotalItens(){
        Double valordesconto=clsaux.capturaValores(txtDescont.getText());
        Double totalger=clsaux.capturaValores(txtTotalgeral.getText());
        Double perc=valordesconto*100/totalger;
        Double vlite=0.00;
        for(int i=0; i<itens.size();i++){
            vlite=clsaux.capturaValores(clsaux.formato(clsaux.capturaValores(itens.get(i).getTotal())*perc/100.0));
           if(valordesconto>=vlite){
                 itens.get(i).setDesconto(vlite.toString());
                 valordesconto=clsaux.capturaValores(clsaux.formato(valordesconto-vlite));
                
            }else{
                itens.get(i).setDesconto(valordesconto.toString());
            }
        }
    
        populaTabelaItens();
    }
    public void carregaDadosAlterar(String idmov){
        clsLancDocCabecalho ld = new clsLancDocCabecalho();
        nf=nfeDAO.retornaDadosMovNf(Long.parseLong(idmov));
        lancDocumentDAO ldDAO= new lancDocumentDAO();
        ld.setIdmovimento(idmov);
        ldDAO.buscaCabecalhoDoc(ld);
        txtMovto.setText(ld.getIdmovimento());
        txtDocumento.setText(ld.getDocument());
        txtSerie.setText(ld.getSerie());
        txtIdParceiro.setText(ld.getIdparceiro());
        txtBaseicms.setText(ld.getBaseicms());
        txtValoricms.setText(ld.getValoricms());
        txtBasest.setText(ld.getBasest());
        txtValorst.setText(ld.getValorst());
        txtOutdesp.setText(ld.getOutrasdesp());
        txtDescont.setText(ld.getDesconto());
        txtTotalprod.setText(ld.getTotalprod());
        txtTotalgeral.setText(ld.getTotal());
        txtValorPis.setText(ld.getValor_pis());
        txtValorCofins.setText(ld.getValor_cofins());
        txtChave.setText(ld.getChaveacesso());
        txtModelo.setText(ld.getModelo());
        txtCfop.setText(ld.getCfop());
        txtvlIpi.setText(ld.getValoripi());
        txtObservacaoNfe.setText(nf.getObservacaoNf());
        ftDatemissao.setText(clsaux.convertDataExib(ld.getEmissao().toString()));
        ftDatlancamento.setText(clsaux.convertDataExib(ld.getLancamento().toString()));
        cbControleInterno.setSelectedItem(ld.getTipomovimento());
        itens=ldDAO.buscaItens(idmovimento);
        carregaComboBox(cbIe, nf.getIndie());
        carregaComboBox(cbIndDest, nf.getInddest());
        carregaComboBox(cbPresComp, nf.getPrescomp());
        carregaComboBox(cbConsFinal, nf.getConsfinal());
        carregaComboBox(cbFibalidade, nf.getFinalidade());
        populaTabelaItens();
        this.carregaInfReferencia();
        this.carregaDadosFinanceiro(idmovimento);
        this.preencheDadosParceiro(ld.getIdparceiro());
     }
    
    public void carregaInfReferencia( ){
        List<String> ret=nfeDAO.retornaInfReferencia(idmovimento);
        DefaultTableModel tb = (DefaultTableModel) tbInfRef.getModel();
        tb.setNumRows(0);
        for(int i=0; i<ret.size(); i++){
            tb.addRow(new Object[]{
                ret.get(i)
            });
        }
    }
    public void carregaComboBox(JComboBox campo,String dado){
        for (int i=0; i<campo.getItemCount(); i++){
            if (dado.trim().equals(clsaux.retornaId(campo.getItemAt(i).toString()).trim())){
                campo.setSelectedIndex(i);
            }
        }
    }
    public void limpaDados(){
        itens.clear();
        numeitem=1;
        
   
   }
    public void carregaDadosFinanceiro(String mov){
        try {
            String sql="select tm.data,tm.valor_recebido,tm.id_finalizadora,tm.sequencia_finalizadora, tf.descricao\n" +
                        "from tpagamentos_adm tm\n" +
                        "join tfinalizadora tf on tm.id_finalizadora=tf.id_finalizdora\n" +
                        "where tm.id_mov=? and tm.estado<>3";
            PreparedStatement ps = conexao.getPreparedStatement(sql);
            ps.setString(1, mov);
            ResultSet rs = ps.executeQuery();
            DefaultTableModel tb = (DefaultTableModel) tblParcelas.getModel();
            tb.setNumRows(0);
            while(rs.next()){
                tb.addRow(new Object[]{
                    clsaux.convertDataExib(rs.getString(1)),
                    clsaux.formato(rs.getDouble(2)),
                    rs.getString(3),
                    rs.getString(4),
                    rs.getString(5)
                });
            }
        } catch (SQLException ex) {
            Logger.getLogger(frmLancamentoNfe.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public void validaDados(){
        if (clsaux.verificaNulo(txtDocumento.getText())==true){
            txtDocumento.setText(nfeDAO.gerarNumeroNfe());
        }
        
        String doc,ser,parceiro=null;
        doc=txtDocumento.getText();
        ser=txtSerie.getText();
        parceiro=txtIdParceiro.getText();
       if(doc.equals("")||ser.equals("")||doc.equals("0")||parceiro.equals("")||parceiro.isEmpty()==true){
           JOptionPane.showMessageDialog(null, "Falta preencher os campos Documento ou Serie ou Parceiro!!!");
       }else {
           this.gravaRegistro();
       }
    }
    public void alteraItem(){
        this.informacoesNfe();
        frmLancamentoItemNfe dialog = new frmLancamentoItemNfe(new javax.swing.JFrame(), true);
        frmLancamentoItemNfe.linha= tbItens.getSelectedRow();
        frmLancamentoItemNfe.item=itens.get(tbItens.getSelectedRow());
        frmLancamentoItemNfe.estadoform="A";
        dialog.inicializa(nf, clsaux.retornaId(cbControleInterno.getSelectedItem()));
        dialog.setVisible(true);
    }
    public void excluiItem(){
        int yn= JOptionPane.showConfirmDialog(null, "Deseja realmente excluir o registro selecionado?", "exclusão de registro", JOptionPane.YES_NO_OPTION);
        if (yn== JOptionPane.YES_OPTION){
            String idite=tbItens.getValueAt(tbItens.getSelectedRow(), 0).toString();
            lancDocumentDAO.excluirItem(idite, txtMovto.getText());
            itens.remove(tbItens.getSelectedRow());
            populaTabelaItens();
        }
        frmLancamentoNfe.calculaTotalDoc();
    }
   
    public clsLancDocument preparaNovoItem(){
        clsLancDocument novo= new clsLancDocument();
            novo.setCodfornecedor("0000");
            novo.setDescricaofornecedor("");
            novo.setBarras("");
            novo.setIdmovto(idmovimento);
            novo.setAcrescimo("0");
            novo.setDesconto("0");
            novo.setNumeroitem(String.valueOf(numeitem));
            novo.setPrecovenda("0");
            novo.setQuantidade("1");
            novo.setTotal("0");
            novo.setUnidade("Un");
            novo.setIdproduto("0");
            novo.setValor_outras("0");
            novo.setValor_seguro("0");
            novo.setValor_frete("0");
            novo.setNcm("0");
            novo.setCst("102");
            novo.setOrigem_produto("0");
            novo.setModbc("3");
            novo.setBase_icms("0");
            novo.setAliq_icms("0");
            novo.setValor_icms("0");
            novo.setValor_st("0");
            novo.setBase_st("0");
            novo.setPis_cofins("0");
            novo.setAliq_pis("0");
            novo.setAliq_cofins("0");
            novo.setAliq_ipi("0");
            novo.setBase_ipi("0");
            novo.setBase_pis("0");
    
        return novo;
    } 
    
    /*funcões referente ao financeiro do lancamento do documento*/
    public void carregaInfFinanceiro(){
        DefaultComboBoxModel tbfi= new DefaultComboBoxModel(listaDAO.listapagamento().toArray());
        CbFinalizadora.setModel(tbfi);
        txtValortotaldocumento.setText(txtTotalgeral.getText());
        txtValorrecebido.setText(txtValortotaldocumento.getText());
    }
    public void calculaValoresFinanceiro(){
        String idfinalizadora=clsaux.retornaId(CbFinalizadora.getSelectedItem().toString());
        String nomefinalizadora=clsaux.retornaAposId(CbFinalizadora.getSelectedItem().toString());
        int parcela=Integer.parseInt(CbParcelas.getSelectedItem().toString());
        Double valor= Double.parseDouble(txtValorrecebido.getText().replaceAll(",", "."));
        Double totalgeral=Double.parseDouble(txtValortotaldocumento.getText().replaceAll(",", "."));
        DefaultTableModel tbl = (DefaultTableModel) tblParcelas.getModel();
        tbl.setNumRows(0);
        if (parcela==1){
            tbl.addRow(new Object[]{
                clsaux.preencheData(),
                clsaux.formato(valor),
                idfinalizadora,
                parcela,
                nomefinalizadora
            });
        }else if (parcela > 1){
            valor= valor/parcela;
            for (int i=0; i<parcela; i++){
                tbl.addRow(new Object []{
                    clsaux.preencheData(),
                    clsaux.formato(valor),
                    idfinalizadora,
                    i,
                    nomefinalizadora
                });
            }
        }
        if(valor>totalgeral){
            txtTroco.setText(clsaux.formato((totalgeral-valor)*-1));
        }
        
    }
    public void gravaFinanceiro(String idmovimentoo){
        CadDocMovConta cd = new CadDocMovConta();
        MovimentoContaDAO mDAO = new MovimentoContaDAO();
        CadContasRecPagar cr = new CadContasRecPagar();
        ContasReceberDAO crDAO= new ContasReceberDAO();
        lancamentoTiroDAO lt= new lancamentoTiroDAO();
        int reg = tblParcelas.getRowCount();
        for (int i=0;i<reg;i++){
            Date data=clsaux.retornaData(tblParcelas.getValueAt(i, 0).toString());
            String valor=tblParcelas.getValueAt(i, 1).toString().replaceAll(",", ".");
            int fin= Integer.parseInt(tblParcelas.getValueAt(i, 2).toString());
            String parcela=tblParcelas.getValueAt(i, 3).toString();
            lt.insereFinalidoraVenda(String.valueOf(fin), valor, idmovimentoo,parcela,0.00,data);
            if (fin<4){
                cd.setData_lancamento(data);
                cd.setData_venc("current_date");
                cd.setDesc_mov("Saida referente a lancamento de documento");
                cd.setEntrada("0.00");
                cd.setSaida(valor);
                cd.setIdconta("1");
                cd.setIdfinalizadora(String.valueOf(fin));
                cd.setIdparceiro(txtIdParceiro.getText());
                cd.setN_doc(txtDocumento.getText());
                cd.setTipo_mov("3");
                cd.setSubtipo_mov("4");
                cd.setIdmov(idmovimentoo);
                cd.setParcela(parcela);
                mDAO.inserir(cd);
            }else if (fin>3){
                cr.setBanco("1");
                cr.setConta("1");
                cr.setDesconto("0.00");
                cr.setEmisao(data);
                cr.setVencimento(data);
                cr.setEstadotitulo("4");
                cr.setFinan(valor);
                cr.setHistorico("1");
                cr.setIdmovto(idmovimentoo);
                cr.setJuros("0.00");
                cr.setNumero(txtDocumento.getText());
                cr.setParceiro(txtIdParceiro.getText());
                cr.setSaldo(valor);
                cr.setTipo("3");
                cr.setTipo_pag(String.valueOf(fin));
                cr.setValor(valor);
                cr.setVendedor("1");
                cr.setParcela(parcela);
                crDAO.insereAltera(cr);
                
            }
            
        }
    }
    public void excluiFinalizadora(){
        DefaultTableModel tb = (DefaultTableModel) tblParcelas.getModel();
        String idfinalizadora=tb.getValueAt(tblParcelas.getSelectedRow(), 2).toString();
        String parcela=tb.getValueAt(tblParcelas.getSelectedRow(), 3).toString();
        lancDocumentDAO lc= new lancDocumentDAO();
        lc.excluiFinalizadora(idmovimento, idfinalizadora, parcela);
        tb.removeRow(tblParcelas.getSelectedRow());
    }
    public void insereFinalizadora(String idmovimento){
        CadDocMovConta cd = new CadDocMovConta();
        MovimentoContaDAO mDAO = new MovimentoContaDAO();
        CadContasRecPagar cr = new CadContasRecPagar();
        ContasReceberDAO crDAO= new ContasReceberDAO();
        lancamentoTiroDAO lt= new lancamentoTiroDAO();
        int idfinalizadora= Integer.parseInt(clsaux.retornaId(CbFinalizadora.getSelectedItem().toString()));
        int parcela=Integer.parseInt(CbParcelas.getSelectedItem().toString());
        Double valordigitado=Double.parseDouble(txtValorrecebido.getText().replaceAll(",", "."));
        valordigitado=valordigitado/parcela;
        for (int i=0; i<parcela; i++){
         lt.insereFinalidoraVenda(String.valueOf(idfinalizadora), valordigitado.toString(), idmovimento,String.valueOf(i),0.00,clsaux.retornaData(clsaux.preencheData()));
         if (idfinalizadora<4){
                cd.setData_lancamento(clsaux.retornaData(clsaux.preencheData()));
                cd.setData_venc("current_date");
                cd.setDesc_mov("Saida referente a lancamento de documento");
                cd.setEntrada("0.00");
                cd.setSaida(valordigitado.toString());
                cd.setIdconta("1");
                cd.setIdfinalizadora(String.valueOf(idfinalizadora));
                cd.setIdparceiro(txtIdParceiro.getText());
                cd.setN_doc(txtDocumento.getText());
                cd.setTipo_mov("3");
                cd.setSubtipo_mov("4");
                cd.setIdmov(idmovimento);
                cd.setParcela(String.valueOf(parcela));
                mDAO.inserir(cd);
            }else if (idfinalizadora>3&& idfinalizadora<8){
                cr.setBanco("1");
                cr.setConta("1");
                cr.setDesconto("0.00");
                cr.setEmisao(clsaux.retornaData(clsaux.preencheData()));
                cr.setVencimento(clsaux.retornaData(clsaux.preencheData()));
                cr.setEstadotitulo("4");
                cr.setFinan(valordigitado.toString());
                cr.setHistorico("1");
                cr.setIdmovto(idmovimento);
                cr.setJuros("0.00");
                cr.setNumero(txtDocumento.getText());
                cr.setParceiro(txtIdParceiro.getText());
                cr.setSaldo(valordigitado.toString());
                cr.setTipo("1");
                cr.setTipo_pag(String.valueOf(idfinalizadora));
                cr.setValor(valordigitado.toString());
                cr.setVendedor("1");
                cr.setParcela(String.valueOf(parcela));
                cr.setTipo_titulo("3");
                cr.setTipofinanceiro("3");
                cr.setSubtipofinanceiro("4");
                crDAO.insereAltera(cr);
            } else if (idfinalizadora==8&& clsConfig.usacreditocliente.equals("S")){
                int tipodocumento=Integer.parseInt(cbFibalidade.getSelectedItem().toString());
                if (tipodocumento==1 || tipodocumento==2 || tipodocumento==5){
                    lt.rateioValorBaixarPorUsoCredito(txtIdParceiro.getText(), valordigitado, idmovimento, "");
                }else{
                    JOptionPane.showMessageDialog(null, "Apenas Movimento de Venda Podem Ser Finalizado Como Uso de Credito!!!");
                }
            } 
            
        }
    }
    
    public static void populaTabelaItens(){
       DefaultTableModel tb= (DefaultTableModel) frmLancamentoNfe.tbItens.getModel();
       tb.setNumRows(0);
       for (int i=0;i<itens.size(); i++){
            tb.addRow(new Object[]{
                itens.get(i).getNumeroitem(),
                itens.get(i).getBarras(),
                itens.get(i).getDescricaofornecedor(),
                itens.get(i).getQuantidade(),
                itens.get(i).getUnidade(),
                itens.get(i).getPrecovenda(),
                itens.get(i).getDesconto(),
                itens.get(i).getAcrescimo(),
                itens.get(i).getTotal(),
                itens.get(i).getCfop(),
                itens.get(i).getCst()
            });
            //numeitem= Integer.parseInt(itens.get(i).getNumeroitem());
        }
   }
    public void adicinaChave(){
        DefaultTableModel tbl= (DefaultTableModel) tbInfRef.getModel();
        tbl.addRow(new Object[]{
            txtChaveAcessoRef.getText()
        });
        txtChaveAcessoRef.setText("");
    }
    public void removeChave(){
        nfeDAO.RemoveInfReferencia(txtMovto.getText(), tbInfRef.getValueAt(tbInfRef.getSelectedRow(), 0).toString());
       tbInfRef.remove(tbInfRef.getSelectedRow());
    }
    
    // funcoes referente a importacao de movimentos
    public void anexarPorId(){
        String origem=clsaux.retornaId(cbOrigem.getSelectedItem());
        String movimento=txtMovAnexar.getText();
        DefaultTableModel tb = (DefaultTableModel) tbAnexosImportar.getModel();
        if(origem.equals("1")){
           clsLancDocCabecalho cl = new clsLancDocCabecalho();
           cl.setIdmovimento(movimento);
           lancDocumentDAO.buscaCabecalhoDoc(cl);
            if(cl.getTipomovimento()!=null){
                tb.addRow(new Object[]{
                    movimento,
                    origem,
                    txtPercentualImporta.getText(),
                    cl.getChaveacesso()
                });
                txtMovAnexar.setText("");
            }
        }else if (origem.equals("2")){
            clsOrcamento orc= new clsOrcamento();
            CondicionalDAO dao= new CondicionalDAO();
            orc.setId(movimento);
            dao.buscaCabecalho(orc);
            if(orc.getEstado()!=null){
                if(orc.getEstado().equals("1")|| orc.getEstado().equals("16")){
                    tb.addRow(new Object[]{
                    movimento,
                    origem,
                    txtPercentualImporta.getText()
                });
                txtMovAnexar.setText("");
                }
            }
            
        }else if (origem.equals("3")){
            clsOrcamento orc= new clsOrcamento();
            orcamentoDAO dao = new orcamentoDAO();
            orc.setId(movimento);
            dao.buscarCabecalho(orc);
            if (orc.getEstado()!=null){
                 tb.addRow(new Object[]{
                    movimento,
                    origem,
                    txtPercentualImporta.getText()
                });
                txtMovAnexar.setText("");
            }
        }else if (origem.equals("4")){
            clsOrdem ordem= new clsOrdem();
            ordem.setIdmovto(movimento);
            orderServicoDAO dao = new orderServicoDAO();
            dao.buscaDadosParaAlterar(ordem);
            if (ordem.getSituacao()!=null){
                tb.addRow(new Object[]{
                    movimento,
                    origem,
                    txtPercentualImporta.getText()
                });
                txtMovAnexar.setText("");
            }
        }
    }
    public void buscarPorLote(){
        String origem= clsaux.retornaId(cbOrigem.getSelectedItem());
        String datainicio,datafim;
        datainicio= ftDataInicioBusca.getText();
        datafim= ftDataFinalBusca.getText();
        DefaultTableModel tb = (DefaultTableModel) tbAnexos.getModel();
        tb.setNumRows(0);
        if(origem.equals("1")){
           clsLancDocCabecalho cl = new clsLancDocCabecalho();
           lancDocumentDAO dao= new lancDocumentDAO();
           List<clsLancDocCabecalho> lista= dao.buscarListaMovimentosData(datainicio, datafim, "65");
           for(clsLancDocCabecalho reg: lista){
               tb.addRow(new Object[]{
                    new Boolean(false),
                    reg.getIdmovimento(),
                    reg.getTotal(),
                    clsaux.convertDataExib(reg.getLancamento().toString()),
                    "",
                    reg.getChaveacesso()
                });
           }
        }else if (origem.equals("2")){
            CondicionalDAO dao= new CondicionalDAO();
            List<clsOrcamento> lista= dao.retornaListaCondicionais(datainicio, datafim, "1");
            for(clsOrcamento reg: lista){
                tb.addRow(new Object[]{
                    new Boolean(false),
                    reg.getId(),
                    clsaux.formato(reg.getTotal()),
                    clsaux.convertDataExib(reg.getData_lancamento().toString()),
                    reg.getParceiro_nome()
                
                });
            }
            
        }else if (origem.equals("3")){
            List<clsOrcamento> orc= new ArrayList();
            orcamentoDAO dao = new orcamentoDAO();
            dao.retornaListaOrcamentos(datafim, datafim);
            for(clsOrcamento novo : orc){
                 tb.addRow(new Object[]{
                     new Boolean(false),
                     novo.getId(),
                    clsaux.formato(novo.getTotal()),
                    clsaux.convertDataExib(novo.getData_lancamento().toString())
                });
               
            }
        }else if (origem.equals("4")){
            orderServicoDAO dao = new orderServicoDAO();
            List<clsOrdem> lista=dao.buscarRegistrosPorData(datainicio, datafim);
            for(clsOrdem novo: lista){
                tb.addRow(new Object[]{
                    new Boolean(false),
                    novo.getIdmovto(),
                    novo.getTotal(),
                    clsaux.convertDataExib(novo.getDataent()),
                   });
            }
        
        }
    
    
    
    }
    public void anexarMarcadosLote(){
        DefaultTableModel tb = (DefaultTableModel) tbAnexosImportar.getModel();
        for(int i=0; i< tbAnexos.getRowCount();i++){
            if((Boolean)tbAnexos.getValueAt(i, 0)==true){
                tb.addRow(new Object[]{
                    tbAnexos.getValueAt(i, 1),
                    clsaux.retornaId(cbOrigem.getSelectedItem()),
                    txtPercentualImporta.getText(),
                    tbAnexos.getValueAt(i, 5)
                });
                
            }
        }
    }
    public void importaRegistosAnexados(){
         String id=null;
         String tipo=null;
         lancDocumentDAO dao = new lancDocumentDAO();
         for(int i=0; i<tbAnexosImportar.getRowCount(); i++){
             tnf_infimportacao inf= new tnf_infimportacao();
             try {
                 // aqui busca os itens e joga na tabela de produtos
                 id=tbAnexosImportar.getValueAt(i, 0).toString();
                 tipo=tbAnexosImportar.getValueAt(i, 1).toString();
                 inf.setTipo(tipo);
                 inf.setIdmvto(txtMovto.getText());
                 inf.setIdorigem(id);
                 inf.setPercentual(100.0);
                 dao.insereRegistrosImportados(inf);
                 List<clsLancDocument> lis= new ArrayList<>();
                 if(tipo.equals("1")){
                      tipo="Nfce";
                      DefaultTableModel tbref= (DefaultTableModel) tbInfRef.getModel();
                      tbref.addRow(new Object[]{
                         tbAnexosImportar.getValueAt(i, 3)
                      });
                 }
                 else if (tipo.equals("2")) tipo="Condicional";
                 else if (tipo.equals("3")) tipo="Pedido";
                 else if (tipo.equals("4")) tipo="OS";
                 System.out.println(tipo+"" +id+"" +txtMovto.getText());
                 lis=dao.retornaListaProdutos(tipo, id, txtMovto.getText());
                 System.out.println(lis.toString());
                 for(clsLancDocument regis : lis){
                     regis.setImportadoNfe("S");
                     itens.add(regis);
                 }
                 
             } catch (SQLException ex) {
                 Logger.getLogger(frmLancamentoNfe.class.getName()).log(Level.SEVERE, null, ex);
                 gravarLog.main(ex.getMessage());
             }
           populaTabelaItens();
           calculaTotalDoc();
           jTabbedPane1.setSelectedIndex(0);
          
       }
    }
    public void limpaRegistrosAnexados(){
        DefaultTableModel tb = (DefaultTableModel) tbAnexosImportar.getModel();
        tb.setNumRows(0);
    }
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(frmLancamentoNfe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(frmLancamentoNfe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(frmLancamentoNfe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(frmLancamentoNfe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>

        /* Create and display the dialog */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                frmLancamentoNfe dialog = new frmLancamentoNfe(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox CbFinalizadora;
    private javax.swing.JComboBox<String> CbParcelas;
    private javax.swing.JButton btnAdicionaChave;
    private javax.swing.JButton btnAdicionaChave1;
    private javax.swing.JButton btnAlterar;
    private javax.swing.JButton btnAnexarMarcado;
    private javax.swing.JButton btnAnexarPorMovimento;
    private javax.swing.JButton btnBuscarReg;
    private javax.swing.JButton btnExcluir;
    private javax.swing.JButton btnExluirPag;
    private javax.swing.JButton btnImportaAnexos;
    private javax.swing.JButton btnIncluir;
    private javax.swing.JButton btnOk;
    private javax.swing.JButton btnPesq;
    private javax.swing.JButton btnRemoveAnexos;
    private javax.swing.JComboBox<String> cbConsFinal;
    private javax.swing.JComboBox<String> cbControleInterno;
    private javax.swing.JComboBox<String> cbFibalidade;
    private javax.swing.JComboBox<String> cbIe;
    private javax.swing.JComboBox<String> cbIndDest;
    private javax.swing.JComboBox<String> cbModFrete;
    private javax.swing.JComboBox<String> cbOrigem;
    private javax.swing.JComboBox<String> cbPresComp;
    private javax.swing.JFormattedTextField ftDataFinalBusca;
    private javax.swing.JFormattedTextField ftDataInicioBusca;
    private javax.swing.JFormattedTextField ftDatemissao;
    private javax.swing.JFormattedTextField ftDatlancamento;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel42;
    private javax.swing.JLabel jLabel43;
    private javax.swing.JLabel jLabel44;
    private javax.swing.JLabel jLabel45;
    private javax.swing.JLabel jLabel46;
    private javax.swing.JLabel jLabel47;
    private javax.swing.JLabel jLabel48;
    private javax.swing.JLabel jLabel49;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel50;
    private javax.swing.JLabel jLabel51;
    private javax.swing.JLabel jLabel52;
    private javax.swing.JLabel jLabel53;
    private javax.swing.JLabel jLabel54;
    private javax.swing.JLabel jLabel55;
    private javax.swing.JLabel jLabel56;
    private javax.swing.JLabel jLabel57;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTable tbAnexos;
    private javax.swing.JTable tbAnexosImportar;
    private javax.swing.JTable tbInfRef;
    public static javax.swing.JTable tbItens;
    private javax.swing.JTable tblParcelas;
    private javax.swing.JTextField txtBaseicms;
    private javax.swing.JTextField txtBasest;
    private javax.swing.JTextField txtCfop;
    private javax.swing.JTextField txtChave;
    private javax.swing.JTextField txtChaveAcessoRef;
    private javax.swing.JTextField txtCidadeTRansportador;
    private javax.swing.JTextField txtCnpj;
    private javax.swing.JTextField txtCnpjTransportadora;
    private static javax.swing.JTextField txtDescont;
    private javax.swing.JTextField txtDocumento;
    private javax.swing.JTextField txtEspecie;
    private javax.swing.JTextField txtFone;
    public static javax.swing.JTextField txtIdParceiro;
    private javax.swing.JTextField txtInscricao;
    private javax.swing.JTextField txtModelo;
    private javax.swing.JTextField txtMovAnexar;
    private javax.swing.JTextField txtMovto;
    private javax.swing.JTextArea txtObservacaoNfe;
    private static javax.swing.JTextField txtOutdesp;
    private javax.swing.JTextField txtPercentualImporta;
    private javax.swing.JTextField txtPesoBruto;
    private javax.swing.JTextField txtPesoLiq;
    private javax.swing.JTextField txtRazaoSocial;
    private javax.swing.JTextField txtRazaoTransportador;
    private javax.swing.JTextField txtSerie;
    private static javax.swing.JTextField txtTotalgeral;
    private static javax.swing.JTextField txtTotalprod;
    private javax.swing.JLabel txtTroco;
    private javax.swing.JTextField txtUfTransportador;
    private static javax.swing.JTextField txtValorCofins;
    private static javax.swing.JTextField txtValorPis;
    private javax.swing.JTextField txtValoricms;
    private javax.swing.JTextField txtValorrecebido;
    private javax.swing.JTextField txtValorst;
    public static javax.swing.JLabel txtValortotaldocumento;
    private javax.swing.JTextField txtVolume;
    private javax.swing.JTextField txtidTransportadora;
    private javax.swing.JTextField txtnumeros;
    private static javax.swing.JTextField txtvlIpi;
    // End of variables declaration//GEN-END:variables

    
}
